<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 6.7, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>GNU macro processor</title>

<meta name="description" content="GNU macro processor">
<meta name="keywords" content="GNU macro processor">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2any">
<link href="#Top" rel="start" title="Top">
<link href="#Concept-index" rel="index" title="Concept index">
<link href="#SEC_Contents" rel="contents" title="Table of Contents">
<link href="dir.html#Top" rel="up" title="(dir)">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


<script defer src="qref.js"></script></head>

<body lang="en">
<h1 class="settitle" align="center">GNU macro processor</h1>






<span id="Top"></span><div class="header">
<p>
Next: <a href="#Preliminaries" accesskey="n" rel="next">Preliminaries</a>, Previous: <a href="dir.html#Top" accesskey="p" rel="prev">(dir)</a>, Up: <a href="dir.html#Top" accesskey="u" rel="up">(dir)</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="GNU-m4"></span><h1 class="top">GNU <code>m4</code></h1>

<p>GNU <code>m4</code> is an implementation of the traditional UNIX macro
processor.  It is mostly SVR4 compatible, although it has some
extensions (for example, handling more than 9 positional parameters
to macros).  <code>m4</code> also has builtin functions for including
files, running shell commands, doing arithmetic, etc.  Autoconf needs
GNU <code>m4</code> for generating <samp>configure</samp> scripts, but not for
running them.
</p>
<p>GNU <code>m4</code> was originally written by Ren&eacute; Seindal, with
subsequent changes by Fran&ccedil;ois Pinard and other volunteers
on the Internet.  All names and email addresses can be found in the
file <samp>THANKS</samp> from the GNU <code>m4</code> distribution.
</p>
<p>This is release 1.4.  It is now to be considered stable,
future releases are only meant to fix bugs, increase speed, or improve
documentation.  However&hellip;
</p>
<p>An experimental feature, which would improve <code>m4</code> usefulness,
allows for changing the syntax for what is a <em>word</em> in <code>m4</code>.
You should use:
</p><div class="example">
<pre class="example">./configure --enable-changeword
</pre></div>
<p>if you want this feature compiled in.  The current implementation
slows down <code>m4</code> considerably and is hardly acceptable.  So, it
might go away, do not count on it yet.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Preliminaries" accesskey="1">Preliminaries</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Introduction and preliminaries
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Syntax" accesskey="2">Syntax</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Lexical and syntactic conventions
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Macros" accesskey="3">Macros</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">How to invoke macros
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Definitions" accesskey="4">Definitions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">How to define new macros
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Conditionals" accesskey="5">Conditionals</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Conditionals and loops
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Debugging" accesskey="6">Debugging</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">How to debug macros and input
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Input-Control" accesskey="7">Input Control</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Input control
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#File-Inclusion" accesskey="8">File Inclusion</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">File inclusion
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Diversions" accesskey="9">Diversions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Diverting and undiverting output
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Text-handling">Text handling</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Macros for text handling
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Arithmetic">Arithmetic</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Macros for doing arithmetic
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#UNIX-commands">UNIX commands</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Macros for running UNIX commands
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Miscellaneous">Miscellaneous</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Miscellaneous builtin macros
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Frozen-files">Frozen files</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Fast loading of frozen states
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Compatibility">Compatibility</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Compatibility with other versions of m4
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Concept-index" rel="index">Concept index</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Index for many concepts
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Macro-index" rel="index">Macro index</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Index for all m4 macros
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

 &mdash; The Detailed Node Listing &mdash;

Introduction and preliminaries

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Intro">Intro</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Introduction to <code>m4</code>
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#History">History</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Historical references
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Invoking-m4">Invoking m4</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Invoking <code>m4</code>
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Bugs">Bugs</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Problems and bugs
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Manual">Manual</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Using this manual
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Lexical and syntactic conventions

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Names">Names</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Macro names
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Quoted-strings">Quoted strings</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Quoting input to m4
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Other-tokens">Other tokens</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Other kinds of input tokens
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Comments">Comments</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Comments in m4 input
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

How to invoke macros

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Invocation">Invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Macro invocation
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Inhibiting-Invocation">Inhibiting Invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Preventing macro invocation
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Macro-Arguments">Macro Arguments</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Macro arguments
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Quoting-Arguments">Quoting Arguments</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">On Quoting Arguments to macros
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Macro-expansion">Macro expansion</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Expanding macros
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

How to define new macros

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Define">Define</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Defining a new macro
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Arguments">Arguments</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Arguments to macros
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Pseudo-Arguments">Pseudo Arguments</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Pseudo arguments to macros
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Undefine">Undefine</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Deleting a macro
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Defn">Defn</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Renaming macros
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Pushdef">Pushdef</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Temporarily redefining macros
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Indir">Indir</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Indirect call of macros
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Builtin">Builtin</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Indirect call of builtins
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Conditionals, loops and recursion

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Ifdef">Ifdef</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Testing if a macro is defined
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Ifelse">Ifelse</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">If-else construct, or multibranch
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Loops">Loops</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Loops and recursion in m4
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

How to debug macros and input

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Dumpdef">Dumpdef</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Displaying macro definitions
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Trace">Trace</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Tracing macro calls
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Debug-Levels">Debug Levels</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Controlling debugging output
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Debug-Output">Debug Output</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Saving debugging output
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Input control

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Dnl">Dnl</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Deleting whitespace in input
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Changequote">Changequote</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Changing the quote characters
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Changecom">Changecom</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Changing the comment delimiters
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Changeword">Changeword</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Changing the lexical structure of words
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#M4wrap">M4wrap</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Saving input until end of input
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

File inclusion

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Include">Include</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Including named files
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Search-Path">Search Path</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Searching for include files
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Diverting and undiverting output

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Divert">Divert</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Diverting output
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Undivert">Undivert</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Undiverting output
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Divnum">Divnum</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Diversion numbers
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Cleardiv">Cleardiv</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Discarding diverted text
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Macros for text handling

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Len">Len</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Calculating length of strings
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Index">Index</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Searching for substrings
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Regexp">Regexp</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Searching for regular expressions
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Substr">Substr</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Extracting substrings
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Translit">Translit</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Translating characters
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Patsubst">Patsubst</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Substituting text by regular expression
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Format">Format</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Formatting strings (printf-like)
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Macros for doing arithmetic

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Incr">Incr</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Decrement and increment operators
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Eval">Eval</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Evaluating integer expressions
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Running UNIX commands

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Syscmd">Syscmd</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Executing simple commands
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Esyscmd">Esyscmd</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Reading the output of commands
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Sysval">Sysval</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Exit codes
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Maketemp">Maketemp</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Making names for temporary files
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Miscellaneous builtin macros

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Errprint">Errprint</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Printing error messages
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#M4exit">M4exit</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Exiting from m4
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

Compatibility with other versions of <code>m4</code>

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Extensions">Extensions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Extensions in GNU m4
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Incompatibilities">Incompatibilities</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Facilities in System V m4 not in GNU m4
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Other-Incompat">Other Incompat</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Other incompatibilities
</td></tr>
</table>


<hr>
<span id="Preliminaries"></span><div class="header">
<p>
Next: <a href="#Syntax" accesskey="n" rel="next">Syntax</a>, Previous: <a href="#Top" accesskey="p" rel="prev">Top</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Introduction-and-preliminaries"></span><h2 class="chapter">1 Introduction and preliminaries</h2>

<p>This first chapter explains what is GNU <code>m4</code>, where <code>m4</code>
comes from, how to read and use this documentation, how to call the
<code>m4</code> program and how to report bugs about it.  It concludes by
giving tips for reading the remainder of the manual.
</p>
<p>The following chapters then detail all the features of the <code>m4</code>
language.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Intro" accesskey="1">Intro</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Introduction to <code>m4</code>
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#History" accesskey="2">History</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Historical references
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Invoking-m4" accesskey="3">Invoking m4</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Invoking <code>m4</code>
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Bugs" accesskey="4">Bugs</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Problems and bugs
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Manual" accesskey="5">Manual</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Using this manual
</td></tr>
</table>

<hr>
<span id="Intro"></span><div class="header">
<p>
Next: <a href="#History" accesskey="n" rel="next">History</a>, Previous: <a href="#Preliminaries" accesskey="p" rel="prev">Preliminaries</a>, Up: <a href="#Preliminaries" accesskey="u" rel="up">Preliminaries</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Introduction-to-m4"></span><h3 class="section">1.1 Introduction to <code>m4</code></h3>

<p><code>m4</code> is a macro processor, in the sense that it copies its
input to the output, expanding macros as it goes.  Macros are either
builtin or user-defined, and can take any number of arguments.
Besides just doing macro expansion, <code>m4</code> has builtin functions
for including named files, running UNIX commands, doing integer
arithmetic, manipulating text in various ways, recursion, etc&hellip;
<code>m4</code> can be used either as a front-end to a compiler, or as a
macro processor in its own right.
</p>
<p>The <code>m4</code> macro processor is widely available on all UNIXes.
Usually, only a small percentage of users are aware of its existence.
However, those who do often become commited users.  The growing
popularity of GNU Autoconf, which prerequires GNU <code>m4</code> for
<em>generating</em> the <samp>configure</samp> scripts, is an incentive
for many to install it, while these people will not themselves
program in <code>m4</code>.  GNU <code>m4</code> is mostly compatible with the
System V, Release 3 version, except for some minor differences.
See <a href="#Compatibility">Compatibility</a> for more details.
</p>
<p>Some people found <code>m4</code> to be fairly addictive.  They first use
<code>m4</code> for simple problems, then take bigger and bigger challenges,
learning how to write complex <code>m4</code> sets of macros along the way.
Once really addicted, users pursue writing of sophisticated <code>m4</code>
applications even to solve simple problems, devoting more time
debugging their <code>m4</code> scripts than doing real work.  Beware that
<code>m4</code> may be dangerous for the health of compulsive programmers.
</p>
<hr>
<span id="History"></span><div class="header">
<p>
Next: <a href="#Invoking-m4" accesskey="n" rel="next">Invoking m4</a>, Previous: <a href="#Intro" accesskey="p" rel="prev">Intro</a>, Up: <a href="#Preliminaries" accesskey="u" rel="up">Preliminaries</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Historical-references"></span><h3 class="section">1.2 Historical references</h3>

<p>The historical notes included here are fairly incomplete, and not
authoritative at all.  Please knowledgeable users help us to more
properly write this section.
</p>
<p><code>GPM</code> has been an important ancestor of <code>m4</code>.  See
C. Stratchey: &ldquo;A General Purpose Macro generator&rdquo;, Computer Journal
8,3 (1965), pp. 225 ff.  <code>GPM</code> is also succintly described into
David Gries classic &ldquo;Compiler Construction for Digital Computers&rdquo;.
</p>
<p>While <code>GPM</code> was <em>pure</em>, <code>m4</code> was meant to deal more
with the true intricacies of real life: macros could be recognized
with being pre-announced, skipping whitespace or end-of-lines was
made easier, more constructs were builtin instead of derived, etc.
</p>
<p>Originally, <code>m4</code> was the engine for Rational FORTRAN preprocessor,
that is, the <code>ratfor</code> equivalent of <code>cpp</code>.
</p>
<hr>
<span id="Invoking-m4"></span><div class="header">
<p>
Next: <a href="#Bugs" accesskey="n" rel="next">Bugs</a>, Previous: <a href="#History" accesskey="p" rel="prev">History</a>, Up: <a href="#Preliminaries" accesskey="u" rel="up">Preliminaries</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Invoking-m4-1"></span><h3 class="section">1.3 Invoking <code>m4</code></h3>

<p>The format of the <code>m4</code> command is:
</p>
<div class="example">
<pre class="example"><code>m4</code> [<var>option</var>&hellip;] [<var>macro-definitions</var>&hellip;] [<var>input-file</var>&hellip;]
</pre></div>

<span id="index-command-line_002c-options"></span>
<span id="index-options_002c-command-line"></span>
<p>All options begin with &lsquo;<samp>-</samp>&rsquo;, or if long option names are used, with
a &lsquo;<samp>--</samp>&rsquo;.  A long option name need not be written completely, and
unambigous prefix is sufficient.  <code>m4</code> understands the following
options:
</p>
<dl compact="compact">
<dt><code>--version</code></dt>
<dd><p>Print the version number of the program on standard output, then
immediately exit <code>m4</code> without reading any <var>input-files</var>.
</p>
</dd>
<dt><code>--help</code></dt>
<dd><p>Print an help summary on standard output, then immediately exit
<code>m4</code> without reading any <var>input-files</var>.
</p>
</dd>
<dt><code>-G</code></dt>
<dt><code>--traditional</code></dt>
<dd><p>Suppress all the extensions made in this implementation, compared to the
System V version.  See <a href="#Compatibility">Compatibility</a>, for a list of these.
</p>
</dd>
<dt><code>-E</code></dt>
<dt><code>--fatal-warnings</code></dt>
<dd><p>Stop execution and exit <code>m4</code> once the first warning has been
issued, considering all of them to be fatal.
</p>
</dd>
<dt><code>-d<var>flags</var></code></dt>
<dt><code>--debug=<var>flags</var></code></dt>
<dd><p>Set the debug-level according to the flags <var>flags</var>.  The debug-level
controls the format and amount of information presented by the debugging
functions.  See <a href="#Debug-Levels">Debug Levels</a> for more details on the format and
meaning of <var>flags</var>.
</p>
</dd>
<dt><code>-l<var>num</var></code></dt>
<dt><code>--arglength=<var>num</var></code></dt>
<dd><p>Restrict the size of the output generated by macro tracing.  See <a href="#Debug-Levels">Debug Levels</a> for more details.
</p>
</dd>
<dt><code>-o<var>file</var></code></dt>
<dt><code>--error-output=<var>file</var></code></dt>
<dd><p>Redirect debug and trace output to the named file.  Error messages are
still printed on the standard error output.  See <a href="#Debug-Output">Debug Output</a> for
more details.
</p>
</dd>
<dt><code>-I<var>dir</var></code></dt>
<dt><code>--include=<var>dir</var></code></dt>
<dd><p>Make <code>m4</code> search <var>dir</var> for included files that are not found in
the current working directory.  See <a href="#Search-Path">Search Path</a> for more details.
</p>
</dd>
<dt><code>-e</code></dt>
<dt><code>--interactive</code></dt>
<dd><p>Makes this invocation of <code>m4</code> interactive.  This means that all
output will be unbuffered, and interrupts will be ignored.
</p>
</dd>
<dt><code>-s</code></dt>
<dt><code>--synclines</code></dt>
<dd><p>Generate synchronisation lines, for use by the C preprocessor or other
similar tools.  This is useful, for example, when <code>m4</code> is used as a
front end to a compiler.  Source file name and line number information
is conveyed by directives of the form &lsquo;<samp>#line <var>linenum</var>
&quot;<var>filename</var>&quot;</samp>&rsquo;, which are inserted as needed into the middle of the
input.  Such directives mean that the following line originated or was
expanded from the contents of input file <var>filename</var> at line
<var>linenum</var>.  The &lsquo;<samp>&quot;<var>filename</var>&quot;</samp>&rsquo; part is often omitted when
the file name did not change from the previous directive.
</p>
<p>Synchronisation directives are always given on complete lines per
themselves.  When a synchronisation discrepancy occurs in the middle of
an output line, the associated synchronisation directive is delayed
until the beginning of the next generated line.
</p>
</dd>
<dt><code>-P</code></dt>
<dt><code>--prefix-builtins</code></dt>
<dd><p>Internally modify <em>all</em> builtin macro names so they all start with
the prefix &lsquo;<samp>m4_</samp>&rsquo;.  For example, using this option, one should write
&lsquo;<samp>m4_define</samp>&rsquo; instead of &lsquo;<samp>define</samp>&rsquo;, and &lsquo;<samp>m4___file__</samp>&rsquo;
instead of &lsquo;<samp>__file__</samp>&rsquo;.
</p>
</dd>
<dt><code>-W<var>REGEXP</var></code></dt>
<dt><code>--word-regexp=<var>REGEXP</var></code></dt>
<dd><p>Use an alternative syntax for macro names.  This experimental
option might not be present on all GNU <code>m4</code> implementations.
(see <a href="#Changeword">Changeword</a>).
</p>
</dd>
<dt><code>-H<var>n</var></code></dt>
<dt><code>--hashsize=<var>n</var></code></dt>
<dd><p>Make the internal hash table for symbol lookup be <var>n</var> entries big.
The number should be prime.  The default is 509 entries.  It should not
be necessary to increase this value, unless you define an excessive
number of macros.
</p>
</dd>
<dt><code>-L<var>n</var></code></dt>
<dt><code>--nesting-limit=<var>n</var></code></dt>
<dd><p>Artificially limit the nesting of macro calls to <var>n</var> levels,
stopping program execution if this limit is ever exceeded.  When not
specified, nesting is limited to 250 levels.
</p>
<p>The precise effect of this option might be more correctly associated
with textual nesting than dynamic recursion.  It has been useful
when some complex <code>m4</code> input was generated by mechanical means.
Most users would never need this option.  If shown to be obtrusive,
this option (which is still experimental) might well disappear.
</p>
<p>This option does <em>not</em> have the ability to break endless
rescanning loops, while these do not necessarily consume much memory
or stack space.  Through clever usage of rescanning loops, one can
request complex, time-consuming computations to <code>m4</code> with useful
results.  Putting limitations in this area would break <code>m4</code> power.
There are many pathological cases: &lsquo;<samp>define(`a',&nbsp;`a')a</samp>&rsquo;<!-- /@w --> is
only the simplest example (but see <a href="#Compatibility">Compatibility</a>).  Expecting GNU
<code>m4</code> to detect these would be a little like expecting a compiler
system to detect and diagnose endless loops: it is a quite <em>hard</em>
problem in general, if not undecidable!
</p>
</dd>
<dt><code>-Q</code></dt>
<dt><code>--quiet</code></dt>
<dt><code>--silent</code></dt>
<dd><p>Suppress warnings about missing or superflous arguments in macro calls.
</p>
</dd>
<dt><code>-B</code></dt>
<dt><code>-S</code></dt>
<dt><code>-T</code></dt>
<dd><p>These options are present for compatibility with System V <code>m4</code>, but
do nothing in this implementation.
</p>
</dd>
<dt><code>-N<var>n</var></code></dt>
<dt><code>--diversions=<var>n</var></code></dt>
<dd><p>These options are present only for compatibility with previous
versions of GNU <code>m4</code>, and were controlling the number of possible
diversions which could be used at the same time.  They do nothing,
because there is no fixed limit anymore.
</p>
</dd>
</dl>

<span id="index-macro-definitions_002c-on-the-command-line"></span>
<span id="index-command-line_002c-macro-definitions-on-the"></span>
<p>Macro definitions and deletions can be made on the command line, by
using the &lsquo;<samp>-D</samp>&rsquo; and &lsquo;<samp>-U</samp>&rsquo; options.  They have the following
format:
</p>
<dl compact="compact">
<dt><code>-D<var>name</var></code></dt>
<dt><code>-D<var>name</var>=<var>value</var></code></dt>
<dt><code>--define=<var>name</var></code></dt>
<dt><code>--define=<var>name</var>=<var>value</var></code></dt>
<dd><p>This enters <var>name</var> into the symbol table, before any input files are
read.  If &lsquo;<samp>=<var>value</var></samp>&rsquo; is missing, the value is taken to be the
empty string.  The <var>value</var> can be any string, and the macro can be
defined to take arguments, just as if it was defined from within the
input.
</p>
</dd>
<dt><code>-U<var>name</var></code></dt>
<dt><code>--undefine=<var>name</var></code></dt>
<dd><p>This deletes any predefined meaning <var>name</var> might have.  Obviously,
only predefined macros can be deleted in this way.
</p>
</dd>
<dt><code>-t<var>name</var></code></dt>
<dt><code>--trace=<var>name</var></code></dt>
<dd><p>This enters <var>name</var> into the symbol table, as undefined but traced.
The macro will consequently be traced from the point it is defined.
</p>
</dd>
<dt><code>-F<var>file</var></code></dt>
<dt><code>--freeze-state <var>file</var></code></dt>
<dd><p>Once execution is finished, write out the frozen state on the specified
<var>file</var> (see <a href="#Frozen-files">Frozen files</a>).
</p>
</dd>
<dt><code>-R<var>file</var></code></dt>
<dt><code>--reload-state <var>file</var></code></dt>
<dd><p>Before execution starts, recover the internal state from the specified
frozen <var>file</var> (see <a href="#Frozen-files">Frozen files</a>).
</p>
</dd>
</dl>

<span id="index-command-line_002c-filenames-on-the"></span>
<span id="index-filenames_002c-on-the-command-line"></span>
<p>The remaining arguments on the command line are taken to be input file
names.  If no names are present, the standard input is read.  A file
name of <samp>-</samp> is taken to mean the standard input.
</p>
<p>The input files are read in the sequence given.  The standard input can
only be read once, so the filename <samp>-</samp> should only appear once on
the command line.
</p>
<hr>
<span id="Bugs"></span><div class="header">
<p>
Next: <a href="#Manual" accesskey="n" rel="next">Manual</a>, Previous: <a href="#Invoking-m4" accesskey="p" rel="prev">Invoking m4</a>, Up: <a href="#Preliminaries" accesskey="u" rel="up">Preliminaries</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Problems-and-bugs"></span><h3 class="section">1.4 Problems and bugs</h3>

<p>If you have problems with GNU <code>m4</code> or think you&rsquo;ve found a bug,
please report it.  Before reporting a bug, make sure you&rsquo;ve actually
found a real bug.  Carefully reread the documentation and see if it
really says you can do what you&rsquo;re trying to do.  If it&rsquo;s not clear
whether you should be able to do something or not, report that too; it&rsquo;s
a bug in the documentation!
</p>
<p>Before reporting a bug or trying to fix it yourself, try to isolate it
to the smallest possible input file that reproduces the problem.  Then
send us the input file and the exact results <code>m4</code> gave you.  Also
say what you expected to occur; this will help us decide whether the
problem was really in the documentation.
</p>
<p>Once you&rsquo;ve got a precise problem, send e-mail to (Internet)
<samp>bug-gnu-utils@prep.ai.mit.edu</samp> or (UUCP)
<samp>mit-eddie!prep.ai.mit.edu!bug-gnu-utils</samp>.  Please include the
version number of <code>m4</code> you are using.  You can get this information
with the command &lsquo;<samp>m4 --version</samp>&rsquo;.
</p>
<p>Non-bug suggestions are always welcome as well.  If you have questions
about things that are unclear in the documentation or are just obscure
features, please report them too.
</p>
<hr>
<span id="Manual"></span><div class="header">
<p>
Previous: <a href="#Bugs" accesskey="p" rel="prev">Bugs</a>, Up: <a href="#Preliminaries" accesskey="u" rel="up">Preliminaries</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Using-this-manual"></span><h3 class="section">1.5 Using this manual</h3>

<p>This manual contains a number of examples of <code>m4</code> input and output,
and a simple notation is used to distinguish input, output and error
messages from <code>m4</code>.  Examples are set out from the normal text, and
shown in a fixed width font, like this
</p>
<div class="example">
<pre class="example">This is an example of an example!
</pre></div>

<p>To distinguish input from output, all output from <code>m4</code> is prefixed
by the string &lsquo;<samp>&rArr;</samp>&rsquo;, and all error messages by the string
&lsquo;<samp>error&rarr;</samp>&rsquo;.  Thus
</p>
<div class="example">
<pre class="example">Example of input line
&rArr;Output line from m4
error&rarr;and an error message
</pre></div>

<p>As each of the predefined macros in <code>m4</code> is described, a prototype
call of the macro will be shown, giving descriptive names to the
arguments, e.g.,
</p>
<div class="example">
<pre class="example">regexp(<var>string</var>, <var>regexp</var>, opt <var>replacement</var>)
</pre></div>

<p>All macro arguments in <code>m4</code> are strings, but some are given special
interpretation, e.g., as numbers, filenames, regular expressions, etc.
</p>
<p>The &lsquo;<samp>opt</samp>&rsquo; before the third argument shows that this argument is
optional&mdash;if it is left out, it is taken to be the empty string.  An
ellipsis (&lsquo;<samp>...</samp>&rsquo;) last in the argument list indicates that any
number of arguments may follow.
</p>
<p>This document consistently writes and uses <em>builtin</em>, without an
hyphen, as if it were an English word.  This is how the <code>builtin</code>
primitive is spelled within <code>m4</code>.
</p>
<hr>
<span id="Syntax"></span><div class="header">
<p>
Next: <a href="#Macros" accesskey="n" rel="next">Macros</a>, Previous: <a href="#Preliminaries" accesskey="p" rel="prev">Preliminaries</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Lexical-and-syntactic-conventions"></span><h2 class="chapter">2 Lexical and syntactic conventions</h2>

<span id="index-input-tokens"></span>
<span id="index-tokens"></span>
<p>As <code>m4</code> reads its input, it separates it into <em>tokens</em>.  A
token is either a name, a quoted string, or any single character, that
is not a part of either a name or a string.  Input to <code>m4</code> can also
contain comments.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Names" accesskey="1">Names</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Macro names
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Quoted-strings" accesskey="2">Quoted strings</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Quoting input to m4
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Other-tokens" accesskey="3">Other tokens</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Other kinds of input tokens
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Comments" accesskey="4">Comments</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Comments in m4 input
</td></tr>
</table>

<hr>
<span id="Names"></span><div class="header">
<p>
Next: <a href="#Quoted-strings" accesskey="n" rel="next">Quoted strings</a>, Previous: <a href="#Syntax" accesskey="p" rel="prev">Syntax</a>, Up: <a href="#Syntax" accesskey="u" rel="up">Syntax</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Names-1"></span><h3 class="section">2.1 Names</h3>

<span id="index-names"></span>
<p>A name is any sequence of letters, digits, and the character <kbd>_</kbd>
(underscore), where the first character is not a digit.  If a
name has a macro definition, it will be subject to macro expansion
(see <a href="#Macros">Macros</a>).
</p>
<p>Examples of legal names are: &lsquo;<samp>foo</samp>&rsquo;, &lsquo;<samp>_tmp</samp>&rsquo;, and &lsquo;<samp>name01</samp>&rsquo;.
</p>
<hr>
<span id="Quoted-strings"></span><div class="header">
<p>
Next: <a href="#Other-tokens" accesskey="n" rel="next">Other tokens</a>, Previous: <a href="#Names" accesskey="p" rel="prev">Names</a>, Up: <a href="#Syntax" accesskey="u" rel="up">Syntax</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Quoted-strings-1"></span><h3 class="section">2.2 Quoted strings</h3>

<span id="index-quoted-string"></span>
<p>A quoted string is a sequence of characters surrounded by the quotes
<kbd>`</kbd> and <kbd>'</kbd>, where the number of start and end quotes within the
string balances.  The value of a string token is the text, with one
level of quotes stripped off.  Thus
</p>
<div class="example">
<pre class="example">`'
</pre></div>

<p>is the empty string, and
</p>
<div class="example">
<pre class="example">`<!-- /@w -->`quoted'<!-- /@w -->'
</pre></div>

<p>is the string
</p>
<div class="example">
<pre class="example">`quoted'
</pre></div>

<p>The quote characters can be changed at any time, using the builtin macro
<code>changequote</code>.  See <a href="#Changequote">Changequote</a> for more information.
</p>
<hr>
<span id="Other-tokens"></span><div class="header">
<p>
Next: <a href="#Comments" accesskey="n" rel="next">Comments</a>, Previous: <a href="#Quoted-strings" accesskey="p" rel="prev">Quoted strings</a>, Up: <a href="#Syntax" accesskey="u" rel="up">Syntax</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Other-tokens-1"></span><h3 class="section">2.3 Other tokens</h3>

<p>Any character, that is neither a part of a name, nor of a quoted string,
is a token by itself.
</p>
<hr>
<span id="Comments"></span><div class="header">
<p>
Previous: <a href="#Other-tokens" accesskey="p" rel="prev">Other tokens</a>, Up: <a href="#Syntax" accesskey="u" rel="up">Syntax</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Comments-1"></span><h3 class="section">2.4 Comments</h3>

<span id="index-comments"></span>
<p>Comments in <code>m4</code> are normally delimited by the characters &lsquo;<samp>#</samp>&rsquo;
and newline.  All characters between the comment delimiters are ignored,
but the entire comment (including the delimiters) is passed through to
the output&mdash;comments are <em>not</em> discarded by <code>m4</code>.
</p>
<p>Comments cannot be nested, so the first newline after a &lsquo;<samp>#</samp>&rsquo; ends
the comment.  The commenting effect of the begin comment character
can be inhibited by quoting it.
</p>
<p>The comment delimiters can be changed to any string at any time, using
the builtin macro <code>changecom</code>.  See <a href="#Changecom">Changecom</a> for more
information.
</p>

<hr>
<span id="Macros"></span><div class="header">
<p>
Next: <a href="#Definitions" accesskey="n" rel="next">Definitions</a>, Previous: <a href="#Syntax" accesskey="p" rel="prev">Syntax</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="How-to-invoke-macros"></span><h2 class="chapter">3 How to invoke macros</h2>

<p>This chapter covers macro invocation, macro arguments and how macro
expansion is treated.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Invocation" accesskey="1">Invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Macro invocation
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Inhibiting-Invocation" accesskey="2">Inhibiting Invocation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Preventing macro invocation
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Macro-Arguments" accesskey="3">Macro Arguments</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Macro arguments
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Quoting-Arguments" accesskey="4">Quoting Arguments</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">On Quoting Arguments to macros
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Macro-expansion" accesskey="5">Macro expansion</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Expanding macros
</td></tr>
</table>

<hr>
<span id="Invocation"></span><div class="header">
<p>
Next: <a href="#Inhibiting-Invocation" accesskey="n" rel="next">Inhibiting Invocation</a>, Previous: <a href="#Macros" accesskey="p" rel="prev">Macros</a>, Up: <a href="#Macros" accesskey="u" rel="up">Macros</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Macro-invocation"></span><h3 class="section">3.1 Macro invocation</h3>

<span id="index-macro-invocation"></span>
<p>Macro invocations has one of the forms
</p>
<div class="example">
<pre class="example">name
</pre></div>

<p>which is a macro invocation without any arguments, or
</p>
<div class="example">
<pre class="example">name(arg1, arg2, ..., arg<var>n</var>)
</pre></div>

<p>which is a macro invocation with <var>n</var> arguments.  Macros can have any
number of arguments.  All arguments are strings, but different macros
might interpret the arguments in different ways.
</p>
<p>The opening parenthesis <em>must</em> follow the <var>name</var> directly, with
no spaces in between.  If it does not, the macro is called with no
arguments at all.
</p>
<p>For a macro call to have no arguments, the parentheses <em>must</em> be
left out.  The macro call
</p>
<div class="example">
<pre class="example">name()
</pre></div>

<p>is a macro call with one argument, which is the empty string, not a call
with no arguments.
</p>
<hr>
<span id="Inhibiting-Invocation"></span><div class="header">
<p>
Next: <a href="#Macro-Arguments" accesskey="n" rel="next">Macro Arguments</a>, Previous: <a href="#Invocation" accesskey="p" rel="prev">Invocation</a>, Up: <a href="#Macros" accesskey="u" rel="up">Macros</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Preventing-macro-invocation"></span><h3 class="section">3.2 Preventing macro invocation</h3>

<p>An innovation of the <code>m4</code> language, compared to some of its
predecessors (like Stratchey&rsquo;s <code>GPM</code>, for example), is the ability
to recognize macro calls without resorting to any special, prefixed
invocation character.  While generally useful, this feature might
sometimes be the source of spurious, unwanted macro calls.  So, GNU
<code>m4</code> offers several mechanisms or techniques for inhibiting the
recognition of names as macro calls.
</p>
<p>First of all, many builtin macros cannot meaningfully be called
without arguments.  For any of these macros, whenever an opening
parenthesis does not immediately follow their name, the builtin macro
call is not triggered.  This solves the most usual cases, like for
&lsquo;<samp>include</samp>&rsquo; or &lsquo;<samp>eval</samp>&rsquo;.  Later in this document, the sentence
&ldquo;This macro is recognized only when given arguments&rdquo; refers to this
specific provision.
</p>
<p>There is also a command call option (<code>--prefix-builtins</code>, or
<code>-P</code>) which requires all builtin macro names to be prefixed
by &lsquo;<samp>m4_</samp>&rsquo; for them to be recognized.  The option has no effect
whatsoever on user defined macros.  For example, with this option,
one has to write <code>m4_dnl</code> and even <code>m4_m4exit</code>.
</p>
<p>If your version of GNU <code>m4</code> has the <code>changeword</code> feature
compiled in, there it offers far more flexibility in specifying the
syntax of macro names, both builtin or user-defined.  See <a href="#Changeword">Changeword</a>
for more information on this experimental feature.
</p>
<p>Of course, the simplest way to prevent a name to be interpreted
as a call to an existing macro is to quote it.  The remainder of
this section studies a little more deeply how quoting affects macro
invocation, and how quoting can be used to inhibit macro invocation.
</p>
<p>Even if quoting is usually done over the whole macro name, it can also
be done over only a few characters of this name.  It is also possible
to quote the empty string, but this works only <em>inside</em> the name.
For example:
</p>
<div class="example">
<pre class="example">`divert'
`d'ivert
di`ver't
div`'ert
</pre></div>

<p>all yield the string &lsquo;<samp>divert</samp>&rsquo;.  While in both:
</p>
<div class="example">
<pre class="example">`'divert
divert`'
</pre></div>

<p>the <code>divert</code> builtin macro will be called.
</p>
<p>The output of macro evaluations is always rescanned.  The following
example would yield the string &lsquo;<samp>de</samp>&rsquo;, exactly as if <code>m4</code>
has been given &lsquo;<samp>substr(abcde,&nbsp;3,&nbsp;2)</samp>&rsquo;<!-- /@w --> as input:
</p>
<div class="example">
<pre class="example">define(`x', `substr(ab')
define(`y', `cde, 3, 2)')
x`'y
</pre></div>

<p>Unquoted strings on either side of a quoted string are subject to
being recognized as macro names.  In the following example, quoting the
empty string allows for the <code>dnl</code> macro to be recognized as such:
</p>
<div class="example">
<pre class="example">define(`macro', `di$1')
macro(v)`'dnl
</pre></div>

<p>Without the quotes, this would rather yield the string &lsquo;<samp>divdnl</samp>&rsquo;
followed by an end of line.
</p>
<p>Quoting may prevent recognizing as a macro name the concatenation of a
macro expansion with the surrounding characters.  In this example:
</p>
<div class="example">
<pre class="example">define(`macro', `di$1')
macro(v)`ert'
</pre></div>

<p>the input will produce the string &lsquo;<samp>divert</samp>&rsquo;.  If the quote was
removed, the <code>divert</code> builtin would be called instead.
</p>
<hr>
<span id="Macro-Arguments"></span><div class="header">
<p>
Next: <a href="#Quoting-Arguments" accesskey="n" rel="next">Quoting Arguments</a>, Previous: <a href="#Inhibiting-Invocation" accesskey="p" rel="prev">Inhibiting Invocation</a>, Up: <a href="#Macros" accesskey="u" rel="up">Macros</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Macro-arguments"></span><h3 class="section">3.3 Macro arguments</h3>

<span id="index-macros_002c-arguments-to"></span>
<span id="index-arguments-to-macros"></span>
<p>When a name is seen, and it has a macro definition, it will be expanded
as a macro.
</p>
<p>If the name is followed by an opening parenthesis, the arguments will be
collected before the macro is called.  If too few arguments are
supplied, the missing arguments are taken to be the empty string.  If
there are too many arguments, the excess arguments are ignored.
</p>
<p>Normally <code>m4</code> will issue warnings if a builtin macro is called
with an inappropriate number of arguments, but it can be suppressed with
the &lsquo;<samp>-Q</samp>&rsquo; command line option.  For user defined macros, there is no
check of the number of arguments given.
</p>
<p>Macros are expanded normally during argument collection, and whatever
commas, quotes and parentheses that might show up in the resulting
expanded text will serve to define the arguments as well.  Thus, if
<var>foo</var> expands to &lsquo;<samp>, b, c</samp>&rsquo;, the macro call
</p>
<div class="example">
<pre class="example">bar(a foo, d)
</pre></div>

<p>is a macro call with four arguments, which are &lsquo;<samp>a </samp>&rsquo;, &lsquo;<samp>b</samp>&rsquo;,
&lsquo;<samp>c</samp>&rsquo; and &lsquo;<samp>d</samp>&rsquo;.  To understand why the first argument contains
whitespace, remember that leading unquoted whitespace is never part
of an argument, but trailing whitespace always is.
</p>
<hr>
<span id="Quoting-Arguments"></span><div class="header">
<p>
Next: <a href="#Macro-expansion" accesskey="n" rel="next">Macro expansion</a>, Previous: <a href="#Macro-Arguments" accesskey="p" rel="prev">Macro Arguments</a>, Up: <a href="#Macros" accesskey="u" rel="up">Macros</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Quoting-macro-arguments"></span><h3 class="section">3.4 Quoting macro arguments</h3>

<span id="index-quoted-macro-arguments"></span>
<span id="index-macros_002c-quoted-arguments-to"></span>
<span id="index-arguments_002c-quoted-macro"></span>
<p>Each argument has leading unquoted whitespace removed.  Within each
argument, all unquoted parentheses must match.  For example, if
<var>foo</var> is a macro,
</p>
<div class="example">
<pre class="example">foo(() (`(') `(')
</pre></div>

<p>is a macro call, with one argument, whose value is &lsquo;<samp>()&nbsp;<!-- /@w -->(()&nbsp;<!-- /@w -->(</samp>&rsquo;.
</p>
<p>It is common practice to quote all arguments to macros, unless you are
sure you want the arguments expanded.  Thus, in the above
example with the parentheses, the &lsquo;right&rsquo; way to do it is like this:
</p>
<div class="example">
<pre class="example">foo(`() (() (')
</pre></div>

<p>It is, however, in certain cases necessary to leave out quotes for some
arguments, and there is nothing wrong in doing it.  It just makes life a
bit harder, if you are not careful.
</p>
<hr>
<span id="Macro-expansion"></span><div class="header">
<p>
Previous: <a href="#Quoting-Arguments" accesskey="p" rel="prev">Quoting Arguments</a>, Up: <a href="#Macros" accesskey="u" rel="up">Macros</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Macro-expansion-1"></span><h3 class="section">3.5 Macro expansion</h3>

<span id="index-macros_002c-expansion-of"></span>
<span id="index-expansion-of-macros"></span>
<p>When the arguments, if any, to a macro call have been collected, the
macro is expanded, and the expansion text is pushed back onto the input
(unquoted), and reread.  The expansion text from one macro call might
therefore result in more macros being called, if the calls are included,
completely or partially, in the first macro calls&rsquo; expansion.
</p>
<p>Taking a very simple example, if <var>foo</var> expands to &lsquo;<samp>bar</samp>&rsquo;, and
<var>bar</var> expands to &lsquo;<samp>Hello world</samp>&rsquo;, the input
</p>
<div class="example">
<pre class="example">foo
</pre></div>

<p>will expand first to &lsquo;<samp>bar</samp>&rsquo;, and when this is reread and
expanded, into &lsquo;<samp>Hello world</samp>&rsquo;.
</p>
<hr>
<span id="Definitions"></span><div class="header">
<p>
Next: <a href="#Conditionals" accesskey="n" rel="next">Conditionals</a>, Previous: <a href="#Macros" accesskey="p" rel="prev">Macros</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="How-to-define-new-macros"></span><h2 class="chapter">4 How to define new macros</h2>

<span id="index-macros_002c-how-to-define-new"></span>
<span id="index-defining-new-macros"></span>
<p>Macros can be defined, redefined and deleted in several different ways.
Also, it is possible to redefine a macro, without losing a previous
value, which can be brought back at a later time.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Define" accesskey="1">Define</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Defining a new macro
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Arguments" accesskey="2">Arguments</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Arguments to macros
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Pseudo-Arguments" accesskey="3">Pseudo Arguments</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Pseudo arguments to macros
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Undefine" accesskey="4">Undefine</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Deleting a macro
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Defn" accesskey="5">Defn</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Renaming macros
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Pushdef" accesskey="6">Pushdef</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Temporarily redefining macros
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">

</pre></th></tr><tr><td align="left" valign="top">&bull; <a href="#Indir" accesskey="7">Indir</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Indirect call of macros
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Builtin" accesskey="8">Builtin</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Indirect call of builtins
</td></tr>
</table>

<hr>
<span id="Define"></span><div class="header">
<p>
Next: <a href="#Arguments" accesskey="n" rel="next">Arguments</a>, Previous: <a href="#Definitions" accesskey="p" rel="prev">Definitions</a>, Up: <a href="#Definitions" accesskey="u" rel="up">Definitions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Defining-a-macro"></span><h3 class="section">4.1 Defining a macro</h3>

<span id="index-define"></span>
<p>The normal way to define or redefine macros is to use the builtin
<code>define</code>:
</p>
<div class="example">
<pre class="example">define(<var>name</var> [, <var>expansion</var>])
</pre></div>

<p>which defines <var>name</var> to expand to <var>expansion</var>.  If
<var>expansion</var> is not given, it is taken to be empty.
</p>
<p>The expansion of <code>define</code> is void.
</p>
<p>The following example defines the macro <var>foo</var> to expand to the text
&lsquo;<samp>Hello World.</samp>&rsquo;.
</p>
<div class="example">
<pre class="example">define(`foo', `Hello world.')
&rArr;
foo
&rArr;Hello world.
</pre></div>

<p>The empty line in the output is there because the newline is not
a part of the macro definition, and it is consequently copied to
the output.  This can be avoided by use of the macro <code>dnl</code>.
See <a href="#Dnl">Dnl</a>, for details.
</p>
<p>The macro <code>define</code> is recognized only with parameters.
</p>
<hr>
<span id="Arguments"></span><div class="header">
<p>
Next: <a href="#Pseudo-Arguments" accesskey="n" rel="next">Pseudo Arguments</a>, Previous: <a href="#Define" accesskey="p" rel="prev">Define</a>, Up: <a href="#Definitions" accesskey="u" rel="up">Definitions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Arguments-to-macros"></span><h3 class="section">4.2 Arguments to macros</h3>

<span id="index-macros_002c-arguments-to-1"></span>
<span id="index-Arguments-to-macros"></span>
<p>Macros can have arguments.  The <var>n</var>th argument is denoted by
<code>$n</code> in the expansion text, and is replaced by the <var>n</var>th actual
argument, when the macro is expanded.  Here is a example of a macro with
two arguments.  It simply exchanges the order of the two arguments.
</p>
<div class="example">
<pre class="example">define(`exch', `$2, $1')
&rArr;
exch(arg1, arg2)
&rArr;arg2, arg1
</pre></div>

<p>This can be used, for example, if you like the arguments to
<code>define</code> to be reversed.
</p>
<div class="example">
<pre class="example">define(`exch', `$2, $1')
&rArr;
define(exch(``expansion text'', ``macro''))
&rArr;
macro
&rArr;expansion text
</pre></div>

<p>See <a href="#Quoting-Arguments">Quoting Arguments</a>, for an explanation of the double quotes.
</p>
<span id="index-GNU-extensions"></span>
<p>GNU <code>m4</code> allows the number following the &lsquo;<samp>$</samp>&rsquo; to consist of one
or more digits, allowing macros to have any number of arguments.  This
is not so in UNIX implementations of <code>m4</code>, which only recognize
one digit.
</p>
<p>As a special case, the zero&rsquo;th argument, <code>$0</code>, is always the name
of the macro being expanded.
</p>
<div class="example">
<pre class="example">define(`test', ``Macro name: $0'')
&rArr;
test
&rArr;Macro name: test
</pre></div>

<p>If you want quoted text to appear as part of the expansion text,
remember that quotes can be nested in quoted strings.  Thus, in
</p>
<div class="example">
<pre class="example">define(`foo', `This is macro `foo'.')
&rArr;
foo
&rArr;This is macro foo.
</pre></div>

<p>The &lsquo;<samp>foo</samp>&rsquo; in the expansion text is <em>not</em> expanded, since it is
a quoted string, and not a name.
</p>
<hr>
<span id="Pseudo-Arguments"></span><div class="header">
<p>
Next: <a href="#Undefine" accesskey="n" rel="next">Undefine</a>, Previous: <a href="#Arguments" accesskey="p" rel="prev">Arguments</a>, Up: <a href="#Definitions" accesskey="u" rel="up">Definitions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Special-arguments-to-macros"></span><h3 class="section">4.3 Special arguments to macros</h3>

<span id="index-special-arguments-to-macros"></span>
<span id="index-macros_002c-special-arguments-to"></span>
<span id="index-arguments-to-macros_002c-special"></span>
<p>There is a special notation for the number of actual arguments supplied,
and for all the actual arguments.
</p>
<p>The number of actual arguments in a macro call is denoted by <code>$#</code>
in the expansion text.  Thus, a macro to display the number of arguments
given can be
</p>
<div class="example">
<pre class="example">define(`nargs', `$#')
&rArr;
nargs
&rArr;0
nargs()
&rArr;1
nargs(arg1, arg2, arg3)
&rArr;3
</pre></div>

<p>The notation <code>$*</code> can be used in the expansion text to denote all
the actual arguments, unquoted, with commas in between.  For example
</p>
<div class="example">
<pre class="example">define(`echo', `$*')
&rArr;
echo(arg1,    arg2, arg3 , arg4)
&rArr;arg1,arg2,arg3 ,arg4
</pre></div>

<p>Often each argument should be quoted, and the notation <code>$@</code> handles
that.  It is just like <code>$*</code>, except that it quotes each argument.
A simple example of that is:
</p>
<div class="example">
<pre class="example">define(`echo', `$@')
&rArr;
echo(arg1,    arg2, arg3 , arg4)
&rArr;arg1,arg2,arg3 ,arg4
</pre></div>

<p>Where did the quotes go?  Of course, they were eaten, when the expanded
text were reread by <code>m4</code>.  To show the difference, try
</p>
<div class="example">
<pre class="example">define(`echo1', `$*')
&rArr;
define(`echo2', `$@')
&rArr;
define(`foo', `This is macro `foo'.')
&rArr;
echo1(foo)
&rArr;This is macro This is macro foo..
echo2(foo)
&rArr;This is macro foo.
</pre></div>

<p>See <a href="#Trace">Trace</a>, if you do not understand this.
</p>
<p>A &lsquo;<samp>$</samp>&rsquo; sign in the expansion text, that is not followed by anything
<code>m4</code> understands, is simply copied to the macro expansion, as any
other text is.
</p>
<div class="example">
<pre class="example">define(`foo', `$$$ hello $$$')
&rArr;
foo
&rArr;$$$ hello $$$
</pre></div>

<p>If you want a macro to expand to something like &lsquo;<samp>$12</samp>&rsquo;, put a pair
of quotes after the <code>$</code>.  This will prevent <code>m4</code> from
interpreting the <code>$</code> sign as a reference to an argument.
</p>
<hr>
<span id="Undefine"></span><div class="header">
<p>
Next: <a href="#Defn" accesskey="n" rel="next">Defn</a>, Previous: <a href="#Pseudo-Arguments" accesskey="p" rel="prev">Pseudo Arguments</a>, Up: <a href="#Definitions" accesskey="u" rel="up">Definitions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Deleting-a-macro"></span><h3 class="section">4.4 Deleting a macro</h3>

<span id="index-macros_002c-how-to-delete"></span>
<span id="index-deleting-macros"></span>
<span id="index-undefining-macros"></span>
<span id="index-undefine"></span>
<p>A macro definition can be removed with <code>undefine</code>:
</p>
<div class="example">
<pre class="example">undefine(<var>name</var>)
</pre></div>

<p>which removes the macro <var>name</var>.  The macro name must necessarily be
quoted, since it will be expanded otherwise.
</p>
<p>The expansion of <code>undefine</code> is void.
</p>
<div class="example">
<pre class="example">foo
&rArr;foo
define(`foo', `expansion text')
&rArr;
foo
&rArr;expansion text
undefine(`foo')
&rArr;
foo
&rArr;foo
</pre></div>

<p>It is not an error for <var>name</var> to have no macro definition.  In that
case, <code>undefine</code> does nothing.
</p>
<p>The macro <code>undefine</code> is recognized only with parameters.
</p>
<hr>
<span id="Defn"></span><div class="header">
<p>
Next: <a href="#Pushdef" accesskey="n" rel="next">Pushdef</a>, Previous: <a href="#Undefine" accesskey="p" rel="prev">Undefine</a>, Up: <a href="#Definitions" accesskey="u" rel="up">Definitions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Renaming-macros"></span><h3 class="section">4.5 Renaming macros</h3>

<span id="index-macros_002c-how-to-rename"></span>
<span id="index-renaming-macros"></span>
<span id="index-defn"></span>
<p>It is possible to rename an already defined macro.  To do this, you need
the builtin <code>defn</code>:
</p>
<div class="example">
<pre class="example">defn(<var>name</var>)
</pre></div>

<p>which expands to the <em>quoted definition</em> of <var>name</var>.  If the
argument is not a defined macro, the expansion is void.
</p>
<p>If <var>name</var> is a user-defined macro, the quoted definition is simply
the quoted expansion text.  If, instead, <var>name</var> is a builtin, the
expansion is a special token, which points to the builtin&rsquo;s internal
definition.  This token is only meaningful as the second argument to
<code>define</code> (and <code>pushdef</code>), and is ignored in any other context.
</p>
<p>Its normal use is best understood through an example, which shows how to
rename <code>undefine</code> to <code>zap</code>:
</p>
<div class="example">
<pre class="example">define(`zap', defn(`undefine'))
&rArr;
zap(`undefine')
&rArr;
undefine(`zap')
&rArr;undefine(zap)
</pre></div>

<p>In this way, <code>defn</code> can be used to copy macro definitions, and also
definitions of builtin macros.  Even if the original macro is removed,
the other name can still be used to access the definition.
</p>
<p>The macro <code>defn</code> is recognized only with parameters.
</p>
<hr>
<span id="Pushdef"></span><div class="header">
<p>
Next: <a href="#Indir" accesskey="n" rel="next">Indir</a>, Previous: <a href="#Defn" accesskey="p" rel="prev">Defn</a>, Up: <a href="#Definitions" accesskey="u" rel="up">Definitions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Temporarily-redefining-macros"></span><h3 class="section">4.6 Temporarily redefining macros</h3>

<span id="index-macros_002c-temporary-redefinition-of"></span>
<span id="index-temporary-redefinition-of-macros"></span>
<span id="index-redefinition-of-macros_002c-temporary"></span>
<p>It is possible to redefine a macro temporarily, reverting to the
previous definition at a later time.
<span id="index-popdef"></span>
<span id="index-pushdef"></span>
This is done with the builtins <code>pushdef</code> and <code>popdef</code>:
</p>
<div class="example">
<pre class="example">pushdef(<var>name</var> [, <var>expansion</var>])
popdef(<var>name</var>)
</pre></div>

<p>which are quite analogous to <code>define</code> and <code>undefine</code>.
</p>
<p>These macros work in a stack-like fashion.  A macro is temporarily
redefined with <code>pushdef</code>, which replaces an existing definition of
<var>name</var>, while saving the previous definition, before the new one is
installed.  If there is no previous definition, <code>pushdef</code> behaves
exactly like <code>define</code>.
</p>
<p>If a macro has several definitions (of which only one is accessible),
the topmost definition can be removed with <code>popdef</code>.  If there is
no previous definition, <code>popdef</code> behaves like <code>undefine</code>.
</p>
<div class="example">
<pre class="example">define(`foo', `Expansion one.')
&rArr;
foo
&rArr;Expansion one.
pushdef(`foo', `Expansion two.')
&rArr;
foo
&rArr;Expansion two.
popdef(`foo')
&rArr;
foo
&rArr;Expansion one.
popdef(`foo')
&rArr;
foo
&rArr;foo
</pre></div>

<p>If a macro with several definitions is redefined with <code>define</code>, the
topmost definition is <em>replaced</em> with the new definition.  If it is
removed with <code>undefine</code>, <em>all</em> the definitions are removed,
and not only the topmost one.
</p>
<div class="example">
<pre class="example">define(`foo', `Expansion one.')
&rArr;
foo
&rArr;Expansion one.
pushdef(`foo', `Expansion two.')
&rArr;
foo
&rArr;Expansion two.
define(`foo', `Second expansion two.')
&rArr;
foo
&rArr;Second expansion two.
undefine(`foo')
&rArr;
foo
&rArr;foo
</pre></div>

<p>It is possible to temporarily redefine a builtin with <code>pushdef</code>
and <code>defn</code>.
</p>
<p>The macros <code>pushdef</code> and <code>popdef</code> are recognized only with
parameters.
</p>
<hr>
<span id="Indir"></span><div class="header">
<p>
Next: <a href="#Builtin" accesskey="n" rel="next">Builtin</a>, Previous: <a href="#Pushdef" accesskey="p" rel="prev">Pushdef</a>, Up: <a href="#Definitions" accesskey="u" rel="up">Definitions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Indirect-call-of-macros"></span><h3 class="section">4.7 Indirect call of macros</h3>

<span id="index-indirect-call-of-macros"></span>
<span id="index-call-of-macros_002c-indirect"></span>
<span id="index-macros_002c-indirect-call-of"></span>
<span id="index-GNU-extensions-1"></span>
<span id="index-indir"></span>
<p>Any macro can be called indirectly with <code>indir</code>:
</p>
<div class="example">
<pre class="example">indir(<var>name</var>, ...)
</pre></div>
<p>which results in a call to the macro <var>name</var>, which is passed the
rest of the arguments.  This can be used to call macros with &ldquo;illegal&rdquo;
names (<code>define</code> allows such names to be defined):
</p>
<div class="example">
<pre class="example">define(`$$internal$macro', `Internal macro (name `$0')')
&rArr;
$$internal$macro
&rArr;$$internal$macro
indir(`$$internal$macro')
&rArr;Internal macro (name $$internal$macro)
</pre></div>

<p>The point is, here, that larger macro packages can have private macros
defined, that will not be called by accident.  They can <em>only</em> be
called through the builtin <code>indir</code>.
</p>

<hr>
<span id="Builtin"></span><div class="header">
<p>
Previous: <a href="#Indir" accesskey="p" rel="prev">Indir</a>, Up: <a href="#Definitions" accesskey="u" rel="up">Definitions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Indirect-call-of-builtins"></span><h3 class="section">4.8 Indirect call of builtins</h3>

<span id="index-indirect-call-of-builtins"></span>
<span id="index-call-of-builtins_002c-indirect"></span>
<span id="index-builtins_002c-indirect-call-of"></span>
<span id="index-GNU-extensions-2"></span>
<span id="index-builtin"></span>
<p>Builtin macros can be called indirectly with <code>builtin</code>:
</p>
<div class="example">
<pre class="example">builtin(<var>name</var>, ...)
</pre></div>
<p>which results in a call to the builtin <var>name</var>, which is passed the
rest of the arguments.  This can be used, if <var>name</var> has been given
another definition that has covered the original.
</p>
<p>The macro <code>builtin</code> is recognized only with parameters.
</p>
<hr>
<span id="Conditionals"></span><div class="header">
<p>
Next: <a href="#Debugging" accesskey="n" rel="next">Debugging</a>, Previous: <a href="#Definitions" accesskey="p" rel="prev">Definitions</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Conditionals_002c-loops-and-recursion"></span><h2 class="chapter">5 Conditionals, loops and recursion</h2>

<p>Macros, expanding to plain text, perhaps with arguments, are not quite
enough.  We would like to have macros expand to different things, based
on decisions taken at run-time.  E.g., we need some kind of conditionals.
Also, we would like to have some kind of loop construct, so we could do
something a number of times, or while some condition is true.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Ifdef" accesskey="1">Ifdef</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Testing if a macro is defined
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Ifelse" accesskey="2">Ifelse</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">If-else construct, or multibranch
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Loops" accesskey="3">Loops</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Loops and recursion in m4
</td></tr>
</table>

<hr>
<span id="Ifdef"></span><div class="header">
<p>
Next: <a href="#Ifelse" accesskey="n" rel="next">Ifelse</a>, Previous: <a href="#Conditionals" accesskey="p" rel="prev">Conditionals</a>, Up: <a href="#Conditionals" accesskey="u" rel="up">Conditionals</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Testing-macro-definitions"></span><h3 class="section">5.1 Testing macro definitions</h3>

<span id="index-conditionals"></span>
<span id="index-ifdef"></span>
<p>There are two different builtin conditionals in <code>m4</code>.  The first is
<code>ifdef</code>:
</p>
<div class="example">
<pre class="example">ifdef(<var>name</var>, <var>string-1</var>, opt <var>string-2</var>)
</pre></div>

<p>which makes it possible to test whether a macro is defined or not.  If
<var>name</var> is defined as a macro, <code>ifdef</code> expands to
<var>string-1</var>, otherwise to <var>string-2</var>.  If <var>string-2</var> is
omitted, it is taken to be the empty string (according to the normal
rules).
</p>
<div class="example">
<pre class="example">ifdef(`foo', ``foo' is defined', ``foo' is not defined')
&rArr;foo is not defined
define(`foo', `')
&rArr;
ifdef(`foo', ``foo' is defined', ``foo' is not defined')
&rArr;foo is defined
</pre></div>

<p>The macro <code>ifdef</code> is recognized only with parameters.
</p>
<hr>
<span id="Ifelse"></span><div class="header">
<p>
Next: <a href="#Loops" accesskey="n" rel="next">Loops</a>, Previous: <a href="#Ifdef" accesskey="p" rel="prev">Ifdef</a>, Up: <a href="#Conditionals" accesskey="u" rel="up">Conditionals</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Comparing-strings"></span><h3 class="section">5.2 Comparing strings</h3>

<span id="index-comparing-strings"></span>
<span id="index-ifelse"></span>
<p>The other conditional, <code>ifelse</code>, is much more powerful.  It can be
used as a way to introduce a long comment, as an if-else construct, or
as a multibranch, depending on the number of arguments supplied:
</p>
<div class="example">
<pre class="example">ifelse(<var>comment</var>)
ifelse(<var>string-1</var>, <var>string-2</var>, <var>equal</var>, opt <var>not-equal</var>)
ifelse(<var>string-1</var>, <var>string-2</var>, <var>equal</var>, ...)
</pre></div>

<p>Used with only one argument, the <code>ifelse</code> simply discards it and
produces no output.  This is a common <code>m4</code> idiom for introducing a
block comment, as an alternative to repeatedly using <code>dnl</code>.  This
special usage is recognized by GNU <code>m4</code>, so that in this case, the
warning about missing arguments is never triggered.
</p>
<p>If called with three or four arguments, <code>ifelse</code> expands into
<var>equal</var>, if <var>string-1</var> and <var>string-2</var> are equal (character
for character), otherwise it expands to <var>not-equal</var>.
</p>
<div class="example">
<pre class="example">ifelse(foo, bar, `true')
&rArr;
ifelse(foo, foo, `true')
&rArr;true
ifelse(foo, bar, `true', `false')
&rArr;false
ifelse(foo, foo, `true', `false')
&rArr;true
</pre></div>

<span id="index-multibranches"></span>
<p>However, <code>ifelse</code> can take more than four arguments.  If given more
than four arguments, <code>ifelse</code> works like a <code>case</code> or <code>switch</code>
statement in traditional programming languages.  If <var>string-1</var> and
<var>string-2</var> are equal, <code>ifelse</code> expands into <var>equal</var>, otherwise
the procedure is repeated with the first three arguments discarded.  This
calls for an example:
</p>
<div class="example">
<pre class="example">ifelse(foo, bar, `third', gnu, gnats, `sixth', `seventh')
&rArr;seventh
</pre></div>

<p>Naturally, the normal case will be slightly more advanced than these
examples.  A common use of <code>ifelse</code> is in macros implementing loops
of various kinds.
</p>
<p>The macro <code>ifelse</code> is recognized only with parameters.
</p>
<hr>
<span id="Loops"></span><div class="header">
<p>
Previous: <a href="#Ifelse" accesskey="p" rel="prev">Ifelse</a>, Up: <a href="#Conditionals" accesskey="u" rel="up">Conditionals</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Loops-and-recursion"></span><h3 class="section">5.3 Loops and recursion</h3>

<span id="index-recursive-macros"></span>
<span id="index-macros_002c-recursive"></span>
<p>There is no direct support for loops in <code>m4</code>, but macros can be
recursive.  There is no limit on the number of recursion levels, other
than those enforced by your hardware and operating system.
</p>
<span id="index-loops"></span>
<p>Loops can be programmed using recursion and the conditionals described
previously.
</p>
<span id="index-shift"></span>
<p>There is a builtin macro, <code>shift</code>, which can, among other things,
be used for iterating through the actual arguments to a macro:
</p>
<div class="example">
<pre class="example">shift(...)
</pre></div>

<p>It takes any number of arguments, and expands to all but the first
argument, separated by commas, with each argument quoted.
</p>
<div class="example">
<pre class="example">shift(bar)
&rArr;
shift(foo, bar, baz)
&rArr;bar,baz
</pre></div>

<p>An example of the use of <code>shift</code> is this macro, which reverses the
order of its arguments:
</p>
<div class="example">
<pre class="example">define(`reverse', `ifelse($#, 0, , $#, 1, ``$1'',
			  `reverse(shift($@)), `$1'')')
&rArr;
reverse
&rArr;
reverse(foo)
&rArr;foo
reverse(foo, bar, gnats, and gnus)
&rArr;and gnus, gnats, bar, foo
</pre></div>

<p>While not a very interesting macro, it does show how simple loops can be
made with <code>shift</code>, <code>ifelse</code> and recursion.
</p>
<span id="index-forloops"></span>
<span id="index-loops_002c-counting"></span>
<span id="index-counting-loops"></span>
<p>Here is an example of a loop macro that implements a simple forloop.  It
can, for example, be used for simple counting:
</p>
<div class="example">
<pre class="example">forloop(`i', 1, 8, `i ')
&rArr;1 2 3 4 5 6 7 8
</pre></div>

<p>The arguments are a name for the iteration variable, the starting value,
the final value, and the text to be expanded for each iteration.  With
this macro, the macro <code>i</code> is defined only within the loop.  After
the loop, it retains whatever value it might have had before.
</p>
<p>For-loops can be nested, like
</p>
<div class="example">
<pre class="example">forloop(`i', 1, 4, `forloop(`j', 1, 8, `(i, j) ')
')
&rArr;(1, 1) (1, 2) (1, 3) (1, 4) (1, 5) (1, 6) (1, 7) (1, 8)
&rArr;(2, 1) (2, 2) (2, 3) (2, 4) (2, 5) (2, 6) (2, 7) (2, 8)
&rArr;(3, 1) (3, 2) (3, 3) (3, 4) (3, 5) (3, 6) (3, 7) (3, 8)
&rArr;(4, 1) (4, 2) (4, 3) (4, 4) (4, 5) (4, 6) (4, 7) (4, 8)
&rArr;
</pre></div>

<p>The implementation of the <code>forloop</code> macro is fairly
straightforward.  The <code>forloop</code> macro itself is simply a wrapper,
which saves the previous definition of the first argument, calls the
internal macro <code>_forloop</code>, and re-establishes the saved definition of
the first argument.
</p>
<p>The macro <code>_forloop</code> expands the fourth argument once, and tests
to see if it is finished.  If it has not finished, it increments
the iteration variable (using the predefined macro <code>incr</code>,
see <a href="#Incr">Incr</a>), and recurses.
</p>
<p>Here is the actual implementation of <code>forloop</code>:
</p>
<div class="example">
<pre class="example">define(`forloop',
       `pushdef(`$1', `$2')_forloop(`$1', `$2', `$3', `$4')popdef(`$1')')
define(`_forloop',
       `$4`'ifelse($1, `$3', ,
		   `define(`$1', incr($1))_forloop(`$1', `$2', `$3', `$4')')')
</pre></div>

<p>Notice the careful use of quotes.  Only three macro arguments are
unquoted, each for its own reason.  Try to find out <em>why</em> these
three arguments are left unquoted, and see what happens if they are
quoted.
</p>
<p>Now, even though these two macros are useful, they are still not robust
enough for general use. They lack even basic error handling of cases
like start value less than final value, and the first argument not being
a name.  Correcting these errors are left as an exercise to the reader.
</p>
<hr>
<span id="Debugging"></span><div class="header">
<p>
Next: <a href="#Input-Control" accesskey="n" rel="next">Input Control</a>, Previous: <a href="#Conditionals" accesskey="p" rel="prev">Conditionals</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="How-to-debug-macros-and-input"></span><h2 class="chapter">6 How to debug macros and input</h2>

<p>When writing macros for <code>m4</code>, most of the time they woould not
work as intended (as is the case with most programming languages).
There is a little support for macro debugging in <code>m4</code>.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Dumpdef" accesskey="1">Dumpdef</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Displaying macro definitions
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Trace" accesskey="2">Trace</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Tracing macro calls
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Debug-Levels" accesskey="3">Debug Levels</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Controlling debugging output
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Debug-Output" accesskey="4">Debug Output</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Saving debugging output
</td></tr>
</table>

<hr>
<span id="Dumpdef"></span><div class="header">
<p>
Next: <a href="#Trace" accesskey="n" rel="next">Trace</a>, Previous: <a href="#Debugging" accesskey="p" rel="prev">Debugging</a>, Up: <a href="#Debugging" accesskey="u" rel="up">Debugging</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Displaying-macro-definitions"></span><h3 class="section">6.1 Displaying macro definitions</h3>

<span id="index-displaying-macro-definitions"></span>
<span id="index-macros_002c-displaying-definitions"></span>
<span id="index-definitions_002c-displaying-macro"></span>
<span id="index-dumpdef"></span>
<p>If you want to see what a name expands into, you can use the builtin
<code>dumpdef</code>:
</p>
<div class="example">
<pre class="example">dumpdef(...)
</pre></div>

<p>which accepts any number of arguments.  If called without any arguments,
it displays the definitions of all known names, otherwise it displays
the definitions of the names given.  The output is printed directly on
the standard error output.
</p>
<p>The expansion of <code>dumpdef</code> is void.
</p>
<div class="example">
<pre class="example">define(`foo', `Hello world.')
&rArr;
dumpdef(`foo')
error&rarr;foo:	`Hello world.'
&rArr;
dumpdef(`define')
error&rarr;define:	&lt;define&gt;
&rArr;
</pre></div>

<p>The last example shows how builtin macros definitions are displayed.
</p>
<p>See <a href="#Debug-Levels">Debug Levels</a> for information on controlling the details of the
display.
</p>
<hr>
<span id="Trace"></span><div class="header">
<p>
Next: <a href="#Debug-Levels" accesskey="n" rel="next">Debug Levels</a>, Previous: <a href="#Dumpdef" accesskey="p" rel="prev">Dumpdef</a>, Up: <a href="#Debugging" accesskey="u" rel="up">Debugging</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Tracing-macro-calls"></span><h3 class="section">6.2 Tracing macro calls</h3>

<span id="index-tracing-macro-expansion"></span>
<span id="index-macro-expansion_002c-tracing"></span>
<span id="index-expansion_002c-tracing-macro"></span>
<span id="index-traceon"></span>
<span id="index-traceoff"></span>
<p>It is possible to trace macro calls and expansions through the builtins
<code>traceon</code> and <code>traceoff</code>:
</p>
<div class="example">
<pre class="example">traceon(...)
traceoff(...)
</pre></div>

<p>When called without any arguments, <code>traceon</code> and <code>traceoff</code>
will turn tracing on and off, respectively,  for all defined macros.
When called with arguments, only the named macros are affected.
</p>
<p>The expansion of <code>traceon</code> and <code>traceoff</code> is void.
</p>
<p>Whenever a traced macro is called and the arguments have been collected,
the call is displayed.  If the expansion of the macro call is not void,
the expansion can be displayed after the call.  The output is printed
directly on the standard error output.
</p>
<div class="example">
<pre class="example">define(`foo', `Hello World.')
&rArr;
define(`echo', `$@')
&rArr;
traceon(`foo', `echo')
&rArr;
foo
error&rarr;m4trace: -1- foo -&gt; `Hello World.'
&rArr;Hello World.
echo(gnus, and gnats)
error&rarr;m4trace: -1- echo(`gnus', `and gnats') -&gt; ``gnus',`and gnats''
&rArr;gnus,and gnats
</pre></div>

<p>The number between dashes is the depth of the expansion.  It is one most
of the time, signifying an expansion at the outermost level, but it
increases when macro arguments contain unquoted macro calls.
</p>
<p>See <a href="#Debug-Levels">Debug Levels</a> for information on controlling the details of the
display.
</p>
<hr>
<span id="Debug-Levels"></span><div class="header">
<p>
Next: <a href="#Debug-Output" accesskey="n" rel="next">Debug Output</a>, Previous: <a href="#Trace" accesskey="p" rel="prev">Trace</a>, Up: <a href="#Debugging" accesskey="u" rel="up">Debugging</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Controlling-debugging-output"></span><h3 class="section">6.3 Controlling debugging output</h3>

<span id="index-controlling-debugging-output"></span>
<span id="index-debugging-output_002c-controlling"></span>
<p>The &lsquo;<samp>-d</samp>&rsquo; option to <code>m4</code> controls the amount of details
presented, when using the macros described in the preceding sections.
</p>
<p>The <var>flags</var> following the option can be one or more of the
following:
</p>
<dl compact="compact">
<dt><code>t</code></dt>
<dd><p>Trace all macro calls made in this invocation of <code>m4</code>.
</p>
</dd>
<dt><code>a</code></dt>
<dd><p>Show the actual arguments in each macro call.  This applies to all macro
calls if the &lsquo;<samp>t</samp>&rsquo; flag is used, otherwise only the macros covered by
calls of <code>traceon</code>.
</p>
</dd>
<dt><code>e</code></dt>
<dd><p>Show the expansion of each macro call, if it is not void.  This applies
to all macro calls if the &lsquo;<samp>t</samp>&rsquo; flag is used, otherwise only the
macros covered by calls of <code>traceon</code>.
</p>
</dd>
<dt><code>q</code></dt>
<dd><p>Quote actual arguments and macro expansions in the display with the
current quotes.
</p>
</dd>
<dt><code>c</code></dt>
<dd><p>Show several trace lines for each macro call.  A line is shown when the
macro is seen, but before the arguments are collected; a second line
when the arguments have been collected and a third line after the call
has completed.
</p>
</dd>
<dt><code>x</code></dt>
<dd><p>Add a unique &lsquo;macro call id&rsquo; to each line of the trace output.  This is
useful in connection with the &lsquo;<samp>c</samp>&rsquo; flag above.
</p>
</dd>
<dt><code>f</code></dt>
<dd><p>Show the name of the current input file in each trace output line.
</p>
</dd>
<dt><code>l</code></dt>
<dd><p>Show the the current input line number in each trace output line.
</p>
</dd>
<dt><code>p</code></dt>
<dd><p>Print a message when a named file is found through the path search
mecanism (see <a href="#Search-Path">Search Path</a>), giving the actual filename used.
</p>
</dd>
<dt><code>i</code></dt>
<dd><p>Print a message each time the current input file is changed, giving file
name and input line number.
</p>
</dd>
<dt><code>V</code></dt>
<dd><p>A shorthand for all of the above flags.
</p></dd>
</dl>

<p>If no flags are specified with the &lsquo;<samp>-d</samp>&rsquo; option, the default is
&lsquo;<samp>aeq</samp>&rsquo;. The examples in the previous two sections assumed the
default flags.
</p>
<span id="index-GNU-extensions-3"></span>
<span id="index-debugmode"></span>
<p>There is a builtin macro <code>debugmode</code>, which allows on-the-fly control of
the debugging output format:
</p>
<div class="example">
<pre class="example">debugmode(opt <var>flags</var>)
</pre></div>
<p>The argument <var>flags</var> should be a subset of the letters listed above.
As special cases, if the argument starts with a &lsquo;<samp>+</samp>&rsquo;, the flags are
added to the current debug flags, and if it starts with a &lsquo;<samp>-</samp>&rsquo;, they
are removed.  If no argument is present, the debugging flags are set to
zero (as if no &lsquo;<samp>-d</samp>&rsquo; was given), and with an empty argument the flags
are reset to the default.
</p>
<hr>
<span id="Debug-Output"></span><div class="header">
<p>
Previous: <a href="#Debug-Levels" accesskey="p" rel="prev">Debug Levels</a>, Up: <a href="#Debugging" accesskey="u" rel="up">Debugging</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Saving-debugging-output"></span><h3 class="section">6.4 Saving debugging output</h3>

<span id="index-saving-debugging-output"></span>
<span id="index-debugging-output_002c-saving"></span>
<span id="index-output_002c-saving-debugging"></span>
<span id="index-GNU-extensions-4"></span>
<span id="index-debugfile"></span>
<p>Debug and tracing output can be redirected to files using either the
&lsquo;<samp>-o</samp>&rsquo; option to <code>m4</code>, or with the builtin macro <code>debugfile</code>:
</p>
<div class="example">
<pre class="example">debugfile(opt <var>filename</var>)
</pre></div>
<p>will send all further debug and trace output to <var>filename</var>.  If
<var>filename</var> is empty, debug and trace output are discarded and if
<code>debugfile</code> is called without any arguments, debug and trace output
are sent to the standard error output.
</p>
<hr>
<span id="Input-Control"></span><div class="header">
<p>
Next: <a href="#File-Inclusion" accesskey="n" rel="next">File Inclusion</a>, Previous: <a href="#Debugging" accesskey="p" rel="prev">Debugging</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Input-control"></span><h2 class="chapter">7 Input control</h2>

<p>This chapter describes various builtin macros for controlling the input
to <code>m4</code>.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Dnl" accesskey="1">Dnl</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Deleting whitespace in input
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Changequote" accesskey="2">Changequote</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Changing the quote characters
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Changecom" accesskey="3">Changecom</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Changing the comment delimiters
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Changeword" accesskey="4">Changeword</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Changing the lexical structure of words
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#M4wrap" accesskey="5">M4wrap</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Saving input until end of input
</td></tr>
</table>

<hr>
<span id="Dnl"></span><div class="header">
<p>
Next: <a href="#Changequote" accesskey="n" rel="next">Changequote</a>, Previous: <a href="#Input-Control" accesskey="p" rel="prev">Input Control</a>, Up: <a href="#Input-Control" accesskey="u" rel="up">Input Control</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Deleting-whitespace-in-input"></span><h3 class="section">7.1 Deleting whitespace in input</h3>

<span id="index-deleting-whitespace-in-input"></span>
<span id="index-dnl"></span>
<p>The builtin <code>dnl</code> reads and discards all characters, up to and
including the first newline:
</p>
<div class="example">
<pre class="example">dnl
</pre></div>
<p>and it is often used in connection with <code>define</code>, to remove the
newline that follow the call to <code>define</code>.  Thus
</p>
<div class="example">
<pre class="example">define(`foo', `Macro `foo'.')dnl A very simple macro, indeed.
foo
&rArr;Macro foo.
</pre></div>

<p>The input up to and including the next newline is discarded, as opposed
to the way comments are treated (see <a href="#Comments">Comments</a>).
</p>
<p>Usually, <code>dnl</code> is immediately followed by an end of line or some
other whitespace.  GNU <code>m4</code> will produce a warning diagnostic if
<code>dnl</code> is followed by an open parenthesis.  In this case, <code>dnl</code>
will collect and process all arguments, looking for a matching close
parenthesis.  All predictable side effects resulting from this
collection will take place.  <code>dnl</code> will return no output.  The
input following the matching close parenthesis up to and including the
next newline, on whatever line containing it, will still be discarded.
</p>
<hr>
<span id="Changequote"></span><div class="header">
<p>
Next: <a href="#Changecom" accesskey="n" rel="next">Changecom</a>, Previous: <a href="#Dnl" accesskey="p" rel="prev">Dnl</a>, Up: <a href="#Input-Control" accesskey="u" rel="up">Input Control</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Changing-the-quote-characters"></span><h3 class="section">7.2 Changing the quote characters</h3>

<span id="index-changing-the-quote-delimiters"></span>
<span id="index-quote-delimiters_002c-changing-the"></span>
<span id="index-changequote"></span>
<p>The default quote delimiters can be changed with the builtin
<code>changequote</code>:
</p>
<div class="example">
<pre class="example">changequote(opt <var>start</var>, opt <var>end</var>)
</pre></div>
<p>where <var>start</var> is the new start-quote delimiter and <var>end</var> is the
new end-quote delimiter.  If any of the arguments are missing, the default
quotes (<code>`</code> and <code>'</code>) are used instead of the void arguments.
</p>
<p>The expansion of <code>changequote</code> is void.
</p>
<div class="example">
<pre class="example">changequote([, ])
&rArr;
define([foo], [Macro [foo].])
&rArr;
foo
&rArr;Macro foo.
</pre></div>

<p>If no single character is appropriate, <var>start</var> and <var>end</var> can be
of any length.
</p>
<div class="example">
<pre class="example">changequote([[, ]])
&rArr;
define([[foo]], [[Macro [[[foo]]].]])
&rArr;
foo
&rArr;Macro [foo].
</pre></div>

<p>Changing the quotes to the empty strings will effectively disable the
quoting mechanism, leaving no way to quote text.
</p>
<div class="example">
<pre class="example">define(`foo', `Macro `FOO'.')
&rArr;
changequote(, )
&rArr;
foo
&rArr;Macro `FOO'.
`foo'
&rArr;`Macro `FOO'.'
</pre></div>

<p>There is no way in <code>m4</code> to quote a string containing an unmatched
left quote, except using <code>changequote</code> to change the current
quotes.
</p>
<p>Neither quote string should start with a letter or &lsquo;<samp>_</samp>&rsquo; (underscore),
as they will be confused with names in the input.  Doing so disables
the quoting mechanism.
</p>
<hr>
<span id="Changecom"></span><div class="header">
<p>
Next: <a href="#Changeword" accesskey="n" rel="next">Changeword</a>, Previous: <a href="#Changequote" accesskey="p" rel="prev">Changequote</a>, Up: <a href="#Input-Control" accesskey="u" rel="up">Input Control</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Changing-comment-delimiters"></span><h3 class="section">7.3 Changing comment delimiters</h3>

<span id="index-changing-comment-delimiters"></span>
<span id="index-comment-delimiters_002c-changing"></span>
<span id="index-changecom"></span>
<p>The default comment delimiters can be changed with the builtin
macro <code>changecom</code>:
</p>
<div class="example">
<pre class="example">changecom(opt <var>start</var>, opt <var>end</var>)
</pre></div>
<p>where <var>start</var> is the new start-comment delimiter and <var>end</var> is
the new end-comment delimiter.  If any of the arguments are void, the
default comment delimiters (<code>#</code> and newline) are used instead of
the void arguments.  The comment delimiters can be of any length.
</p>
<p>The expansion of <code>changecom</code> is void.
</p>
<div class="example">
<pre class="example">define(`comment', `COMMENT')
&rArr;
# A normal comment
&rArr;# A normal comment
changecom(`/*', `*/')
&rArr;
# Not a comment anymore
&rArr;# Not a COMMENT anymore
But: /* this is a comment now */ while this is not a comment
&rArr;But: /* this is a comment now */ while this is not a COMMENT
</pre></div>

<span id="index-comments_002c-copied-to-output"></span>
<p>Note how comments are copied to the output, much as if they were quoted
strings.  If you want the text inside a comment expanded, quote the
start comment delimiter.
</p>
<p>Calling <code>changecom</code> without any arguments disables the commenting
mechanism completely.
</p>
<div class="example">
<pre class="example">define(`comment', `COMMENT')
&rArr;
changecom
&rArr;
# Not a comment anymore
&rArr;# Not a COMMENT anymore
</pre></div>

<hr>
<span id="Changeword"></span><div class="header">
<p>
Next: <a href="#M4wrap" accesskey="n" rel="next">M4wrap</a>, Previous: <a href="#Changecom" accesskey="p" rel="prev">Changecom</a>, Up: <a href="#Input-Control" accesskey="u" rel="up">Input Control</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Changing-the-lexical-structure-of-words"></span><h3 class="section">7.4 Changing the lexical structure of words</h3>

<span id="index-lexical-structure-of-words"></span>
<span id="index-words_002c-lexical-structure-of"></span>
<span id="index-changeword"></span>
<blockquote>
<p>The macro <code>changeword</code> and all associated functionnality is
experimental.  It is only available if the <code>--enable-changeword</code>
option was given to <code>configure</code>, at GNU <code>m4</code> installation
time.  The functionnality might change or even go away in the future.
<em>Do not rely on it</em>.  Please direct your comments about it the
same way you would do for bugs.
</p></blockquote>

<p>A file being processed by <code>m4</code> is split into quoted strings, words
(potential macro names) and simple tokens (any other single character).
Initially a word is defined by the following regular expression:
</p>
<div class="example">
<pre class="example">[_a-zA-Z][_a-zA-Z0-9]*
</pre></div>

<p>Using <code>changeword</code>, you can change this regular expression.  Relaxing
<code>m4</code>&rsquo;s lexical rules might be useful (for example) if you wanted to
apply translations to a file of numbers:
</p>
<div class="example">
<pre class="example">changeword(`[_a-zA-Z0-9]+')
define(1, 0)
&rArr;1
</pre></div>

<p>Tightening the lexical rules is less useful, because it will generally
make some of the builtins unavailable.  You could use it to prevent
accidental call of builtins, for example:
</p>
<div class="example">
<pre class="example">define(`_indir', defn(`indir'))
changeword(`_[_a-zA-Z0-9]*')
esyscmd(foo)
_indir(`esyscmd', `ls')
</pre></div>

<p>Because <code>m4</code> constructs its words a character at a time, there
is a restriction on the regular expressions that may be passed to
<code>changeword</code>.  This is that if your regular expression accepts
&lsquo;<samp>foo</samp>&rsquo;, it must also accept &lsquo;<samp>f</samp>&rsquo; and &lsquo;<samp>fo</samp>&rsquo;.
</p>
<p><code>changeword</code> has another function.  If the regular expression
supplied contains any bracketed subexpressions, then text outside
the first of these is discarded before symbol lookup.  So:
</p>
<div class="example">
<pre class="example">changecom(`/*', `*/')
changeword(`#\([_a-zA-Z0-9]*\)')
#esyscmd(ls)
</pre></div>

<p><code>m4</code> now requires a &lsquo;<samp>#</samp>&rsquo; mark at the beginning of every
macro invocation, so one can use <code>m4</code> to preprocess shell
scripts without getting <code>shift</code> commands swallowed, and plain
text without losing various common words.
</p>
<p><code>m4</code>&rsquo;s macro substitution is based on text, while TeX&rsquo;s is based
on tokens.  <code>changeword</code> can throw this difference into relief.  For
example, here is the same idea represented in TeX and <code>m4</code>.
First, the TeX version:
</p>
<div class="example">
<pre class="example">\def\a{\message{Hello}}
\catcode`\@=0
\catcode`\\=12
&rArr;@a
&rArr;@bye
</pre></div>

<p>Then, the <code>m4</code> version:
</p>
<div class="example">
<pre class="example">define(a, `errprint(`Hello')')
changeword(`@\([_a-zA-Z0-9]*\)')
&rArr;@a
</pre></div>

<p>In the TeX example, the first line defines a macro <code>a</code> to
print the message &lsquo;<samp>Hello</samp>&rsquo;.  The second line defines <tt class="key">@</tt> to
be usable instead of <tt class="key">\</tt> as an escape character.  The third line
defines <tt class="key">\</tt> to be a normal printing character, not an escape.
The fourth line invokes the macro <code>a</code>.  So, when TeX is run
on this file, it displays the message &lsquo;<samp>Hello</samp>&rsquo;.
</p>
<p>When the <code>m4</code> example is passed through <code>m4</code>, it outputs
&lsquo;<samp>errprint(Hello)</samp>&rsquo;.  The reason for this is that TeX does
lexical analysis of macro definition when the macro is <em>defined</em>.
<code>m4</code> just stores the text, postponing the lexical analysis until
the macro is <em>used</em>.
</p>
<p>You should note that using <code>changeword</code> will slow <code>m4</code> down
by a factor of about seven.
</p>
<hr>
<span id="M4wrap"></span><div class="header">
<p>
Previous: <a href="#Changeword" accesskey="p" rel="prev">Changeword</a>, Up: <a href="#Input-Control" accesskey="u" rel="up">Input Control</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Saving-input"></span><h3 class="section">7.5 Saving input</h3>

<span id="index-saving-input"></span>
<span id="index-input_002c-saving"></span>
<span id="index-m4wrap"></span>
<p>It is possible to &lsquo;save&rsquo; some text until the end of the normal input has
been seen.  Text can be saved, to be read again by <code>m4</code> when the
normal input has been exhausted.  This feature is normally used to
initiate cleanup actions before normal exit, e.g., deleting temporary
files.
</p>
<p>To save input text, use the builtin <code>m4wrap</code>:
</p>
<div class="example">
<pre class="example">m4wrap(<var>string</var>, ...)
</pre></div>
<p>which stores <var>string</var> and the rest of the arguments in a safe place,
to be reread when end of input is reached.
</p>
<div class="example">
<pre class="example">define(`cleanup', `This is the `cleanup' actions.
')
&rArr;
m4wrap(`cleanup')
&rArr;
This is the first and last normal input line.
&rArr;This is the first and last normal input line.
^D
&rArr;This is the cleanup actions.
</pre></div>

<p>The saved input is only reread when the end of normal input is seen, and
not if <code>m4exit</code> is used to exit <code>m4</code>.
</p>
<p>It is safe to call <code>m4wrap</code> from saved text, but then the order in
which the saved text is reread is undefined.  If <code>m4wrap</code> is not used
recursively, the saved pieces of text are reread in the opposite order
in which they were saved (LIFO&mdash;last in, first out).
</p>
<hr>
<span id="File-Inclusion"></span><div class="header">
<p>
Next: <a href="#Diversions" accesskey="n" rel="next">Diversions</a>, Previous: <a href="#Input-Control" accesskey="p" rel="prev">Input Control</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="File-inclusion"></span><h2 class="chapter">8 File inclusion</h2>

<span id="index-file-inclusion"></span>
<span id="index-inclusion_002c-of-files"></span>

<p><code>m4</code> allows you to include named files at any point in the input.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Include" accesskey="1">Include</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Including named files
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Search-Path" accesskey="2">Search Path</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Searching for include files
</td></tr>
</table>

<hr>
<span id="Include"></span><div class="header">
<p>
Next: <a href="#Search-Path" accesskey="n" rel="next">Search Path</a>, Previous: <a href="#File-Inclusion" accesskey="p" rel="prev">File Inclusion</a>, Up: <a href="#File-Inclusion" accesskey="u" rel="up">File Inclusion</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Including-named-files"></span><h3 class="section">8.1 Including named files</h3>

<span id="index-include"></span>
<span id="index-sinclude"></span>
<p>There are two builtin macros in <code>m4</code> for including files:
</p>
<div class="example">
<pre class="example">include(<var>filename</var>)
sinclude(<var>filename</var>)
</pre></div>

<p>both of which cause the file named <var>filename</var> to be read by
<code>m4</code>.  When the end of the file is reached, input is resumed from
the previous input file.
</p>
<p>The expansion of <code>include</code> and <code>sinclude</code> is therefore the
contents of <var>filename</var>.
</p>
<p>It is an error for an <code>include</code>d file not to exist.  If you do
not want error messages about non-existent files, <code>sinclude</code> can
be used to include a file, if it exists, expanding to nothing if it
does not.
</p>
<div class="example">
<pre class="example">include(`no-such-file')
&rArr;
error&rarr;30.include:2: m4: Cannot open no-such-file: No such file or directory
sinclude(`no-such-file')
&rArr;
</pre></div>

<p>Assume in the following that the file <samp>incl.m4</samp> contains the lines:
</p><div class="example">
<pre class="example">Include file start
foo
Include file end
</pre></div>
<p>Normally file inclusion is used to insert the contents of a file
into the input stream.  The contents of the file will be read by
<code>m4</code> and macro calls in the file will be expanded:
</p>
<div class="example">
<pre class="example">define(`foo', `FOO')
&rArr;
include(`incl.m4')
&rArr;Include file start
&rArr;FOO
&rArr;Include file end
&rArr;
</pre></div>

<p>The fact that <code>include</code> and <code>sinclude</code> expand to the contents
of the file can be used to define macros that operate on entire files.
Here is an example, which defines &lsquo;<samp>bar</samp>&rsquo; to expand to the contents
of <samp>incl.m4</samp>:
</p>
<div class="example">
<pre class="example">define(`bar', include(`incl.m4'))
&rArr;
This is `bar':  &gt;&gt;&gt;bar&lt;&lt;&lt;
&rArr;This is bar:  &gt;&gt;&gt;Include file start
&rArr;foo
&rArr;Include file end
&rArr;&lt;&lt;&lt;
</pre></div>

<p>This use of <code>include</code> is not trivial, though, as files can contain
quotes, commas and parentheses, which can interfere with the way the
<code>m4</code> parser works.
</p>
<p>The builtin macros <code>include</code> and <code>sinclude</code> are recognized
only when given arguments.
</p>
<hr>
<span id="Search-Path"></span><div class="header">
<p>
Previous: <a href="#Include" accesskey="p" rel="prev">Include</a>, Up: <a href="#File-Inclusion" accesskey="u" rel="up">File Inclusion</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Searching-for-include-files"></span><h3 class="section">8.2 Searching for include files</h3>

<span id="index-search-path-for-included-files"></span>
<span id="index-included-files_002c-search-path-for"></span>
<span id="index-GNU-extensions-5"></span>
<p>GNU <code>m4</code> allows included files to be found in other directories
than the current working directory.
</p>
<p>If a file is not found in the current working directory, and the file
name is not absolute, the file will be looked for in a specified search
path.  First, the directories specified with the &lsquo;<samp>-I</samp>&rsquo; option will
be searched, in the order found on the command line.  Second, if the
&lsquo;<samp>M4PATH</samp>&rsquo; environment variable is set, it is expected to contain a
colon-separated list of directories, which will be searched in order.
</p>
<p>If the automatic search for include-files causes trouble, the &lsquo;<samp>p</samp>&rsquo;
debug flag (see <a href="#Debug-Levels">Debug Levels</a>) can help isolate the problem.
</p>
<hr>
<span id="Diversions"></span><div class="header">
<p>
Next: <a href="#Text-handling" accesskey="n" rel="next">Text handling</a>, Previous: <a href="#File-Inclusion" accesskey="p" rel="prev">File Inclusion</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Diverting-and-undiverting-output"></span><h2 class="chapter">9 Diverting and undiverting output</h2>

<p>Diversions are a way of temporarily saving output.  The output of
<code>m4</code> can at any time be diverted to a temporary file, and be
reinserted into the output stream, <em>undiverted</em>, again at a later
time.
</p>
<p>Numbered diversions are counted from 0 upwards, diversion number 0
being the normal output stream.  The number of simultaneous diversions
is limited mainly by the memory used to describe them, because GNU
<code>m4</code> tries to keep diversions in memory.  However, there is a
limit to the overall memory usable by all diversions taken altogether
(512K, currently).  When this maximum is about to be exceeded,
a temporary file is opened to receive the contents of the biggest
diversion still in memory, freeing this memory for other diversions.
So, it is theoretically possible that the number of diversions be
limited by the number of available file descriptors.
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Divert" accesskey="1">Divert</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Diverting output
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Undivert" accesskey="2">Undivert</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Undiverting output
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Divnum" accesskey="3">Divnum</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Diversion numbers
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Cleardiv" accesskey="4">Cleardiv</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Discarding diverted text
</td></tr>
</table>

<hr>
<span id="Divert"></span><div class="header">
<p>
Next: <a href="#Undivert" accesskey="n" rel="next">Undivert</a>, Previous: <a href="#Diversions" accesskey="p" rel="prev">Diversions</a>, Up: <a href="#Diversions" accesskey="u" rel="up">Diversions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Diverting-output"></span><h3 class="section">9.1 Diverting output</h3>

<span id="index-diverting-output-to-files"></span>
<span id="index-output_002c-diverting-to-files"></span>
<span id="index-files_002c-diverting-output-to"></span>
<span id="index-divert"></span>
<p>Output is diverted using <code>divert</code>:
</p>
<div class="example">
<pre class="example">divert(opt <var>number</var>)
</pre></div>

<p>where <var>number</var> is the diversion to be used.  If <var>number</var> is left
out, it is assumed to be zero.
</p>
<p>The expansion of <code>divert</code> is void.
</p>
<p>When all the <code>m4</code> input will have been processed, all existing
diversions are automatically undiverted, in numerical order.
</p>
<div class="example">
<pre class="example">divert(1)
This text is diverted.
divert
&rArr;
This text is not diverted.
&rArr;This text is not diverted.
^D
&rArr;
&rArr;This text is diverted.
</pre></div>

<p>Several calls of <code>divert</code> with the same argument do not overwrite
the previous diverted text, but append to it.
</p>
<p>If output is diverted to a non-existent diversion, it is simply
discarded.  This can be used to suppress unwanted output.  A common
example of unwanted output is the trailing newlines after macro
definitions.  Here is how to avoid them.
</p>
<div class="example">
<pre class="example">divert(-1)
define(`foo', `Macro `foo'.')
define(`bar', `Macro `bar'.')
divert
&rArr;
</pre></div>

<p>This is a common programming idiom in <code>m4</code>.
</p>
<hr>
<span id="Undivert"></span><div class="header">
<p>
Next: <a href="#Divnum" accesskey="n" rel="next">Divnum</a>, Previous: <a href="#Divert" accesskey="p" rel="prev">Divert</a>, Up: <a href="#Diversions" accesskey="u" rel="up">Diversions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Undiverting-output"></span><h3 class="section">9.2 Undiverting output</h3>

<span id="index-undivert"></span>
<p>Diverted text can be undiverted explicitly using the builtin
<code>undivert</code>:
</p>
<div class="example">
<pre class="example">undivert(opt <var>number</var>, ...)
</pre></div>

<p>which undiverts the diversions given by the arguments, in the order
given.  If no arguments are supplied, all diversions are undiverted, in
numerical order.
</p>

<p>The expansion of <code>undivert</code> is void.
</p>
<div class="example">
<pre class="example">divert(1)
This text is diverted.
divert
&rArr;
This text is not diverted.
&rArr;This text is not diverted.
undivert(1)
&rArr;
&rArr;This text is diverted.
&rArr;
</pre></div>

<p>Notice the last two blank lines.  One of them comes from the newline
following <code>undivert</code>, the other from the newline that followed the
<code>divert</code>!  A diversion often starts with a blank line like this.
</p>
<p>When diverted text is undiverted, it is <em>not</em> reread by <code>m4</code>,
but rather copied directly to the current output, and it is therefore
not an error to undivert into a diversion.
</p>
<p>When a diversion has been undiverted, the diverted text is discarded,
and it is not possible to bring back diverted text more than once.
</p>
<div class="example">
<pre class="example">divert(1)
This text is diverted first.
divert(0)undivert(1)dnl
&rArr;
&rArr;This text is diverted first.
undivert(1)
&rArr;
divert(1)
This text is also diverted but not appended.
divert(0)undivert(1)dnl
&rArr;
&rArr;This text is also diverted but not appended.
</pre></div>

<p>Attempts to undivert the current diversion are silently ignored.
</p>
<span id="index-GNU-extensions-6"></span>
<span id="index-file-inclusion-1"></span>
<span id="index-inclusion_002c-of-files-1"></span>
<p>GNU <code>m4</code> allows named files to be undiverted.  Given a non-numeric
argument, the contents of the file named will be copied, uninterpreted, to
the current output.  This complements the builtin <code>include</code>
(see <a href="#Include">Include</a>).  To illustrate the difference, assume the file
<samp>foo</samp> contains the word &lsquo;<samp>bar</samp>&rsquo;:
</p>
<div class="example">
<pre class="example">define(`bar', `BAR')
&rArr;
undivert(`foo')
&rArr;bar
&rArr;
include(`foo')
&rArr;BAR
&rArr;
</pre></div>

<hr>
<span id="Divnum"></span><div class="header">
<p>
Next: <a href="#Cleardiv" accesskey="n" rel="next">Cleardiv</a>, Previous: <a href="#Undivert" accesskey="p" rel="prev">Undivert</a>, Up: <a href="#Diversions" accesskey="u" rel="up">Diversions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Diversion-numbers"></span><h3 class="section">9.3 Diversion numbers</h3>

<span id="index-diversion-numbers"></span>
<span id="index-divnum"></span>
<p>The builtin <code>divnum</code>:
</p>
<div class="example">
<pre class="example">divnum
</pre></div>

<p>expands to the number of the current diversion.
</p>
<div class="example">
<pre class="example">Initial divnum
&rArr;Initial 0
divert(1)
Diversion one: divnum
divert(2)
Diversion two: divnum
divert
&rArr;
^D
&rArr;
&rArr;Diversion one: 1
&rArr;
&rArr;Diversion two: 2
</pre></div>

<p>The last call of <code>divert</code> without argument is necessary, since the
undiverted text would otherwise be diverted itself.
</p>
<hr>
<span id="Cleardiv"></span><div class="header">
<p>
Previous: <a href="#Divnum" accesskey="p" rel="prev">Divnum</a>, Up: <a href="#Diversions" accesskey="u" rel="up">Diversions</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Discarding-diverted-text"></span><h3 class="section">9.4 Discarding diverted text</h3>

<span id="index-discarding-diverted-text"></span>
<span id="index-diverted-text_002c-discarding"></span>
<p>Often it is not known, when output is diverted, whether the diverted
text is actually needed.  Since all non-empty diversion are brought back
on the main output stream when the end of input is seen, a method of
discarding a diversion is needed.  If all diversions should be
discarded, the easiest is to end the input to <code>m4</code> with
&lsquo;<samp>divert(-1)</samp>&rsquo; followed by an explicit &lsquo;<samp>undivert</samp>&rsquo;:
</p>
<div class="example">
<pre class="example">divert(1)
Diversion one: divnum
divert(2)
Diversion two: divnum
divert(-1)
undivert
^D
</pre></div>

<p>No output is produced at all.
</p>
<p>Clearing selected diversions can be done with the following macro:
</p>
<div class="example">
<pre class="example">define(`cleardivert',
`pushdef(`_num', divnum)divert(-1)undivert($@)divert(_num)popdef(`_num')')
&rArr;
</pre></div>

<p>It is called just like <code>undivert</code>, but the effect is to clear the
diversions, given by the arguments.  (This macro has a nasty bug!  You
should try to see if you can find it and correct it.)
</p>
<hr>
<span id="Text-handling"></span><div class="header">
<p>
Next: <a href="#Arithmetic" accesskey="n" rel="next">Arithmetic</a>, Previous: <a href="#Diversions" accesskey="p" rel="prev">Diversions</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Macros-for-text-handling"></span><h2 class="chapter">10 Macros for text handling</h2>

<p>There are a number of builtins in <code>m4</code> for manipulating text in
various ways, extracting substrings, searching, substituting, and so on.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Len" accesskey="1">Len</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Calculating length of strings
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Index" accesskey="2">Index</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Searching for substrings
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Regexp" accesskey="3">Regexp</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Searching for regular expressions
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Substr" accesskey="4">Substr</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Extracting substrings
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Translit" accesskey="5">Translit</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Translating characters
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Patsubst" accesskey="6">Patsubst</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Substituting text by regular expression
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Format" accesskey="7">Format</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Formatting strings (printf-like)
</td></tr>
</table>

<hr>
<span id="Len"></span><div class="header">
<p>
Next: <a href="#Index" accesskey="n" rel="next">Index</a>, Previous: <a href="#Text-handling" accesskey="p" rel="prev">Text handling</a>, Up: <a href="#Text-handling" accesskey="u" rel="up">Text handling</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Calculating-length-of-strings"></span><h3 class="section">10.1 Calculating length of strings</h3>

<span id="index-length-of-strings"></span>
<span id="index-strings_002c-length-of"></span>
<span id="index-len"></span>
<p>The length of a string can be calculated by <code>len</code>:
</p>
<div class="example">
<pre class="example">len(<var>string</var>)
</pre></div>

<p>which expands to the length of <var>string</var>, as a decimal number.
</p>
<div class="example">
<pre class="example">len()
&rArr;0
len(`abcdef')
&rArr;6
</pre></div>

<p>The builtin macro <code>len</code> is recognized only when given arguments.
</p>
<hr>
<span id="Index"></span><div class="header">
<p>
Next: <a href="#Regexp" accesskey="n" rel="next">Regexp</a>, Previous: <a href="#Len" accesskey="p" rel="prev">Len</a>, Up: <a href="#Text-handling" accesskey="u" rel="up">Text handling</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Searching-for-substrings"></span><h3 class="section">10.2 Searching for substrings</h3>

<span id="index-index"></span>
<p>Searching for substrings is done with <code>index</code>:
</p>
<div class="example">
<pre class="example">index(<var>string</var>, <var>substring</var>)
</pre></div>

<p>which expands to the index of the first occurrence of <var>substring</var> in
<var>string</var>.  The first character in <var>string</var> has index 0.  If
<var>substring</var> does not occur in <var>string</var>, <code>index</code> expands to
&lsquo;<samp>-1</samp>&rsquo;.
</p>
<div class="example">
<pre class="example">index(`gnus, gnats, and armadillos', `nat')
&rArr;7
index(`gnus, gnats, and armadillos', `dag')
&rArr;-1
</pre></div>

<p>The builtin macro <code>index</code> is recognized only when given arguments.
</p>
<hr>
<span id="Regexp"></span><div class="header">
<p>
Next: <a href="#Substr" accesskey="n" rel="next">Substr</a>, Previous: <a href="#Index" accesskey="p" rel="prev">Index</a>, Up: <a href="#Text-handling" accesskey="u" rel="up">Text handling</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Searching-for-regular-expressions"></span><h3 class="section">10.3 Searching for regular expressions</h3>

<span id="index-regular-expressions"></span>
<span id="index-GNU-extensions-7"></span>
<span id="index-regexp"></span>
<p>Searching for regular expressions is done with the builtin
<code>regexp</code>:
</p>
<div class="example">
<pre class="example">regexp(<var>string</var>, <var>regexp</var>, opt <var>replacement</var>)
</pre></div>

<p>which searches for <var>regexp</var> in <var>string</var>.  The syntax for regular
expressions is the same as in GNU Emacs.  See <a href="https://www.gnu.org/software/emacs/manual/html_mono/emacs.html#Regexps">Syntax of
Regular Expressions</a> in <cite>The GNU Emacs Manual</cite>.
</p>
<p>If <var>replacement</var> is omitted, <code>regexp</code> expands to the index of
the first match of <var>regexp</var> in <var>string</var>.  If <var>regexp</var> does
not match anywhere in <var>string</var>, it expands to -1.
</p>
<div class="example">
<pre class="example">regexp(`GNUs not Unix', `\&lt;[a-z]\w+')
&rArr;5
regexp(`GNUs not Unix', `\&lt;Q\w*')
&rArr;-1
</pre></div>

<p>If <var>replacement</var> is supplied, <code>regexp</code> changes the expansion
to this argument, with &lsquo;<samp>\<var>n</var></samp>&rsquo; substituted by the text
matched by the <var>n</var>th parenthesized sub-expression of <var>regexp</var>,
&lsquo;<samp>\&amp;</samp>&rsquo; being the text the entire regular expression matched.
</p>
<div class="example">
<pre class="example">regexp(`GNUs not Unix', `\w\(\w+\)$', `*** \&amp; *** \1 ***')
&rArr;*** Unix *** nix ***
</pre></div>

<p>The builtin macro <code>regexp</code> is recognized only when given arguments.
</p>
<hr>
<span id="Substr"></span><div class="header">
<p>
Next: <a href="#Translit" accesskey="n" rel="next">Translit</a>, Previous: <a href="#Regexp" accesskey="p" rel="prev">Regexp</a>, Up: <a href="#Text-handling" accesskey="u" rel="up">Text handling</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Extracting-substrings"></span><h3 class="section">10.4 Extracting substrings</h3>

<span id="index-extracting-substrings"></span>
<span id="index-substrings_002c-extracting"></span>
<span id="index-substr"></span>
<p>Substrings are extracted with <code>substr</code>:
</p>
<div class="example">
<pre class="example">substr(<var>string</var>, <var>from</var>, opt <var>length</var>)
</pre></div>

<p>which expands to the substring of <var>string</var>, which starts at index
<var>from</var>, and extends for <var>length</var> characters, or to the end of
<var>string</var>, if <var>length</var> is omitted.  The starting index of a string
is always 0.
</p>
<div class="example">
<pre class="example">substr(`gnus, gnats, and armadillos', 6)
&rArr;gnats, and armadillos
substr(`gnus, gnats, and armadillos', 6, 5)
&rArr;gnats
</pre></div>

<p>The builtin macro <code>substr</code> is recognized only when given arguments.
</p>
<hr>
<span id="Translit"></span><div class="header">
<p>
Next: <a href="#Patsubst" accesskey="n" rel="next">Patsubst</a>, Previous: <a href="#Substr" accesskey="p" rel="prev">Substr</a>, Up: <a href="#Text-handling" accesskey="u" rel="up">Text handling</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Translating-characters"></span><h3 class="section">10.5 Translating characters</h3>

<span id="index-translating-characters"></span>
<span id="index-characters_002c-translating"></span>
<span id="index-translit"></span>
<p>Character translation is done with <code>translit</code>:
</p>
<div class="example">
<pre class="example">translit(<var>string</var>, <var>chars</var>, <var>replacement</var>)
</pre></div>

<p>which expands to <var>string</var>, with each character that occurs in
<var>chars</var> translated into the character from <var>replacement</var> with
the same index.
</p>
<p>If <var>replacement</var> is shorter than <var>chars</var>, the excess characters
are deleted from the expansion.  If <var>replacement</var> is omitted, all
characters in <var>string</var>, that are present in <var>chars</var> are deleted
from the expansion.
</p>
<p>Both <var>chars</var> and <var>replacement</var> can contain character-ranges,
e.g., &lsquo;<samp>a-z</samp>&rsquo; (meaning all lowercase letters) or &lsquo;<samp>0-9</samp>&rsquo; (meaning
all digits).  To include a dash &lsquo;<samp>-</samp>&rsquo; in <var>chars</var> or
<var>replacement</var>, place it first or last.
</p>
<p>It is not an error for the last character in the range to be &lsquo;larger&rsquo;
than the first.  In that case, the range runs backwards, i.e.,
&lsquo;<samp>9-0</samp>&rsquo; means the string &lsquo;<samp>9876543210</samp>&rsquo;.
</p>
<div class="example">
<pre class="example">translit(`GNUs not Unix', `A-Z')
&rArr;s not nix
translit(`GNUs not Unix', `a-z', `A-Z')
&rArr;GNUS NOT UNIX
translit(`GNUs not Unix', `A-Z', `z-a')
&rArr;tmfs not fnix
</pre></div>

<p>The first example deletes all uppercase letters, the second converts
lowercase to uppercase, and the third &lsquo;mirrors&rsquo; all uppercase letters,
while converting them to lowercase.  The two first cases are by far the
most common.
</p>
<p>The builtin macro <code>translit</code> is recognized only when given
arguments.
</p>
<hr>
<span id="Patsubst"></span><div class="header">
<p>
Next: <a href="#Format" accesskey="n" rel="next">Format</a>, Previous: <a href="#Translit" accesskey="p" rel="prev">Translit</a>, Up: <a href="#Text-handling" accesskey="u" rel="up">Text handling</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Substituting-text-by-regular-expression"></span><h3 class="section">10.6 Substituting text by regular expression</h3>

<span id="index-regular-expressions-1"></span>
<span id="index-pattern-substitution"></span>
<span id="index-substitution-by-regular-expression"></span>
<span id="index-GNU-extensions-8"></span>
<span id="index-patsubst"></span>
<p>Global substitution in a string is done by <code>patsubst</code>:
</p>
<div class="example">
<pre class="example">patsubst(<var>string</var>, <var>regexp</var>, opt <var>replacement</var>)
</pre></div>
<p>which searches <var>string</var> for matches of <var>regexp</var>, and substitutes
<var>replacement</var> for each match.  The syntax for regular expressions
is the same as in GNU Emacs.
</p>
<p>The parts of <var>string</var> that are not covered by any match of
<var>regexp</var> are copied to the expansion.  Whenever a match is found, the
search proceeds from the end of the match, so a character from
<var>string</var> will never be substituted twice.  If <var>regexp</var> matches a
string of zero length, the start position for the search is incremented,
to avoid infinite loops.
</p>
<p>When a replacement is to be made, <var>replacement</var> is inserted into
the expansion, with &lsquo;<samp>\<var>n</var></samp>&rsquo; substituted by the text matched by
the <var>n</var>th parenthesized sub-expression of <var>regexp</var>, &lsquo;<samp>\&amp;</samp>&rsquo;
being the text the entire regular expression matched.
</p>
<p>The <var>replacement</var> argument can be omitted, in which case the text
matched by <var>regexp</var> is deleted.
</p>
<div class="example">
<pre class="example">patsubst(`GNUs not Unix', `^', `OBS: ')
&rArr;OBS: GNUs not Unix
patsubst(`GNUs not Unix', `\&lt;', `OBS: ')
&rArr;OBS: GNUs OBS: not OBS: Unix
patsubst(`GNUs not Unix', `\w*', `(\&amp;)')
&rArr;(GNUs)() (not)() (Unix)
patsubst(`GNUs not Unix', `\w+', `(\&amp;)')
&rArr;(GNUs) (not) (Unix)
patsubst(`GNUs not Unix', `[A-Z][a-z]+')
&rArr;GN not 
</pre></div>

<p>Here is a slightly more realistic example, which capitalizes individual
word or whole sentences, by substituting calls of the macros
<code>upcase</code> and <code>downcase</code> into the strings.
</p>
<div class="example">
<pre class="example">define(`upcase', `translit(`$*', `a-z', `A-Z')')dnl
define(`downcase', `translit(`$*', `A-Z', `a-z')')dnl
define(`capitalize1',
     `regexp(`$1', `^\(\w\)\(\w*\)', `upcase(`\1')`'downcase(`\2')')')dnl
define(`capitalize',
     `patsubst(`$1', `\w+', `capitalize1(`\&amp;')')')dnl
capitalize(`GNUs not Unix')
&rArr;Gnus Not Unix
</pre></div>

<p>The builtin macro <code>patsubst</code> is recognized only when given
arguments.
</p>
<hr>
<span id="Format"></span><div class="header">
<p>
Previous: <a href="#Patsubst" accesskey="p" rel="prev">Patsubst</a>, Up: <a href="#Text-handling" accesskey="u" rel="up">Text handling</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Formatted-output"></span><h3 class="section">10.7 Formatted output</h3>

<span id="index-formatted-output"></span>
<span id="index-output_002c-formatted"></span>
<span id="index-GNU-extensions-9"></span>
<span id="index-format"></span>
<p>Formatted output can be made with <code>format</code>:
</p>
<div class="example">
<pre class="example">format(<var>format-string</var>, ...)
</pre></div>

<p>which works much like the C function <code>printf</code>.  The first argument
is a format string, which can contain &lsquo;<samp>%</samp>&rsquo; specifications, and the
expansion of <code>format</code> is the formatted string.
</p>
<p>Its use is best described by a few examples:
</p>
<div class="example">
<pre class="example">define(`foo', `The brown fox jumped over the lazy dog')
&rArr;
format(`The string &quot;%s&quot; is %d characters long', foo, len(foo))
&rArr;The string &quot;The brown fox jumped over the lazy dog&quot; is 38 characters long
</pre></div>

<p>Using the <code>forloop</code> macro defined in See <a href="#Loops">Loops</a>, this
example shows how <code>format</code> can be used to produce tabular output.
</p>
<div class="example">
<pre class="example">forloop(`i', 1, 10, `format(`%6d squared is %10d
', i, eval(i**2))')
&rArr;     1 squared is	    1
&rArr;     2 squared is	    4
&rArr;     3 squared is	    9
&rArr;     4 squared is	   16
&rArr;     5 squared is	   25
&rArr;     6 squared is	   36
&rArr;     7 squared is	   49
&rArr;     8 squared is	   64
&rArr;     9 squared is	   81
&rArr;    10 squared is	  100
</pre></div>

<p>The builtin <code>format</code> is modeled after the ANSI C &lsquo;<samp>printf</samp>&rsquo;
function, and supports the normal &lsquo;<samp>%</samp>&rsquo; specifiers: &lsquo;<samp>c</samp>&rsquo;,
&lsquo;<samp>s</samp>&rsquo;, &lsquo;<samp>d</samp>&rsquo;, &lsquo;<samp>o</samp>&rsquo;, &lsquo;<samp>x</samp>&rsquo;, &lsquo;<samp>X</samp>&rsquo;, &lsquo;<samp>u</samp>&rsquo;, &lsquo;<samp>e</samp>&rsquo;,
&lsquo;<samp>E</samp>&rsquo; and &lsquo;<samp>f</samp>&rsquo;; it supports field widths and precisions, and the
modifiers &lsquo;<samp>+</samp>&rsquo;, &lsquo;<samp>-</samp>&rsquo;, &lsquo;<samp>&nbsp;<!-- /@w --></samp>&rsquo;, &lsquo;<samp>0</samp>&rsquo;, &lsquo;<samp>#</samp>&rsquo;, &lsquo;<samp>h</samp>&rsquo; and
&lsquo;<samp>l</samp>&rsquo;.  For more details on the functioning of <code>printf</code>, see the
C Library Manual.
</p>

<hr>
<span id="Arithmetic"></span><div class="header">
<p>
Next: <a href="#UNIX-commands" accesskey="n" rel="next">UNIX commands</a>, Previous: <a href="#Text-handling" accesskey="p" rel="prev">Text handling</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Macros-for-doing-arithmetic"></span><h2 class="chapter">11 Macros for doing arithmetic</h2>

<span id="index-arithmetic"></span>
<span id="index-integer-arithmetic"></span>
<p>Integer arithmetic is included in <code>m4</code>, with a C-like syntax.  As
convenient shorthands, there are builtins for simple increment and
decrement operations.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Incr" accesskey="1">Incr</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Decrement and increment operators
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Eval" accesskey="2">Eval</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Evaluating integer expressions
</td></tr>
</table>

<hr>
<span id="Incr"></span><div class="header">
<p>
Next: <a href="#Eval" accesskey="n" rel="next">Eval</a>, Previous: <a href="#Arithmetic" accesskey="p" rel="prev">Arithmetic</a>, Up: <a href="#Arithmetic" accesskey="u" rel="up">Arithmetic</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Decrement-and-increment-operators"></span><h3 class="section">11.1 Decrement and increment operators</h3>

<span id="index-decrement-operator"></span>
<span id="index-increment-operator"></span>
<span id="index-incr"></span>
<span id="index-decr"></span>
<p>Increment and decrement of integers are supported using the builtins
<code>incr</code> and <code>decr</code>:
</p>
<div class="example">
<pre class="example">incr(<var>number</var>)
decr(<var>number</var>)
</pre></div>

<p>which expand to the numerical value of <var>number</var>, incremented,
or decremented, respectively, by one.
</p>
<div class="example">
<pre class="example">incr(4)
&rArr;5
decr(7)
&rArr;6
</pre></div>

<p>The builtin macros <code>incr</code> and <code>decr</code> are recognized only when
given arguments.
</p>
<hr>
<span id="Eval"></span><div class="header">
<p>
Previous: <a href="#Incr" accesskey="p" rel="prev">Incr</a>, Up: <a href="#Arithmetic" accesskey="u" rel="up">Arithmetic</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Evaluating-integer-expressions"></span><h3 class="section">11.2 Evaluating integer expressions</h3>

<span id="index-integer-expression-evaluation"></span>
<span id="index-evaluation_002c-of-integer-expressions"></span>
<span id="index-expressions_002c-evaluation-of-integer"></span>
<span id="index-eval"></span>
<p>Integer expressions are evaluated with <code>eval</code>:
</p>
<div class="example">
<pre class="example">eval(<var>expression</var>, opt <var>radix</var>, opt <var>width</var>)
</pre></div>

<p>which expands to the value of <var>expression</var>.
</p>
<p>Expressions can contain the following operators, listed in order of
decreasing precedence.
</p>
<dl compact="compact">
<dt><code>-</code></dt>
<dd><p>Unary minus
</p></dd>
<dt><code>**</code></dt>
<dd><p>Exponentiation
</p></dd>
<dt><code>*  /  %</code></dt>
<dd><p>Multiplication, division and modulo
</p></dd>
<dt><code>+  -</code></dt>
<dd><p>Addition and subtraction
</p></dd>
<dt><code>&lt;&lt;  &gt;&gt;</code></dt>
<dd><p>Shift left or right
</p></dd>
<dt><code>==  !=  &gt;  &gt;=  &lt;  &lt;=</code></dt>
<dd><p>Relational operators
</p></dd>
<dt><code>!</code></dt>
<dd><p>Logical negation
</p></dd>
<dt><code>~</code></dt>
<dd><p>Bitwise negation
</p></dd>
<dt><code>&amp;</code></dt>
<dd><p>Bitwise and
</p></dd>
<dt><code>^</code></dt>
<dd><p>Bitwise exclusive-or
</p></dd>
<dt><code>|</code></dt>
<dd><p>Bitwise or
</p></dd>
<dt><code>&amp;&amp;</code></dt>
<dd><p>Logical and
</p></dd>
<dt><code>||</code></dt>
<dd><p>Logical or
</p></dd>
</dl>

<p>All operators, except exponentiation, are left associative.
</p>
<p>Note that many <code>m4</code> implementations use &lsquo;<samp>^</samp>&rsquo; as an alternate
operator for the exponentiation, while many others use &lsquo;<samp>^</samp>&rsquo; for the
bitwise exclusive-or.  GNU <code>m4</code> changed its behavior: it used to
exponentiate for &lsquo;<samp>^</samp>&rsquo;, it now computes the bitwise exclusive-or.
</p>
<p>Numbers without special prefix are given decimal.  A simple &lsquo;<samp>0</samp>&rsquo;
prefix introduces an octal number.  &lsquo;<samp>0x</samp>&rsquo; introduces an hexadecimal
number.  &lsquo;<samp>0b</samp>&rsquo; introduces a binary number.  &lsquo;<samp>0r</samp>&rsquo; introduces a
number expressed in any radix between 1 and 36: the prefix should be
immediately followed by the decimal expression of the radix, a colon,
then the digits making the number.  For any radix, the digits are
&lsquo;<samp>0</samp>&rsquo;, &lsquo;<samp>1</samp>&rsquo;, &lsquo;<samp>2</samp>&rsquo;, &hellip;.  Beyond &lsquo;<samp>9</samp>&rsquo;, the digits are
&lsquo;<samp>a</samp>&rsquo;, &lsquo;<samp>b</samp>&rsquo; &hellip; up to &lsquo;<samp>z</samp>&rsquo;.  Lower and upper case letters
can be used interchangeably in numbers prefixes and as number digits.
</p>
<p>Parentheses may be used to group subexpressions whenever needed.  For the
relational operators, a true relation returns <code>1</code>, and a false
relation return <code>0</code>.
</p>
<p>Here are a few examples of use of <code>eval</code>.
</p>
<div class="example">
<pre class="example">eval(-3 * 5)
&rArr;-15
eval(index(`Hello world', `llo') &gt;= 0)
&rArr;1
define(`square', `eval(($1)**2)')
&rArr;
square(9)
&rArr;81
square(square(5)+1)
&rArr;676
define(`foo', `666')
&rArr;
eval(`foo'/6)
error&rarr;51.eval:14: m4: Bad expression in eval: foo/6
&rArr;
eval(foo/6)
&rArr;111
</pre></div>

<p>As the second to last example shows, <code>eval</code> does not handle macro
names, even if they expand to a valid expression (or part of a valid
expression).  Therefore all macros must be expanded before they are
passed to <code>eval</code>.
</p>
<p>If <var>radix</var> is specified, it specifies the radix to be used in the
expansion.  The default radix is 10.  The result of <code>eval</code> is
always taken to be signed.  The <var>width</var> argument specifies a minimum
output width.  The result is zero-padded to extend the expansion to the
requested width.
</p>
<div class="example">
<pre class="example">eval(666, 10)
&rArr;666
eval(666, 11)
&rArr;556
eval(666, 6)
&rArr;3030
eval(666, 6, 10)
&rArr;0000003030
eval(-666, 6, 10)
&rArr;-000003030
</pre></div>

<p>Take note that <var>radix</var> cannot be larger than 36.
</p>
<p>The builtin macro <code>eval</code> is recognized only when given arguments.
</p>
<hr>
<span id="UNIX-commands"></span><div class="header">
<p>
Next: <a href="#Miscellaneous" accesskey="n" rel="next">Miscellaneous</a>, Previous: <a href="#Arithmetic" accesskey="p" rel="prev">Arithmetic</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Running-UNIX-commands"></span><h2 class="chapter">12 Running UNIX commands</h2>

<span id="index-executing-UNIX-commands"></span>
<span id="index-running-UNIX-commands"></span>
<span id="index-UNIX-commands_002c-running"></span>
<span id="index-commands_002c-running-UNIX"></span>
<p>There are a few builtin macros in <code>m4</code> that allow you to run UNIX
commands from within <code>m4</code>.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Syscmd" accesskey="1">Syscmd</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Executing simple commands
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Esyscmd" accesskey="2">Esyscmd</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Reading the output of commands
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Sysval" accesskey="3">Sysval</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Exit codes
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Maketemp" accesskey="4">Maketemp</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Making names for temporary files
</td></tr>
</table>

<hr>
<span id="Syscmd"></span><div class="header">
<p>
Next: <a href="#Esyscmd" accesskey="n" rel="next">Esyscmd</a>, Previous: <a href="#UNIX-commands" accesskey="p" rel="prev">UNIX commands</a>, Up: <a href="#UNIX-commands" accesskey="u" rel="up">UNIX commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Executing-simple-commands"></span><h3 class="section">12.1 Executing simple commands</h3>

<span id="index-syscmd"></span>
<p>Any shell command can be executed, using <code>syscmd</code>:
</p>
<div class="example">
<pre class="example">syscmd(<var>shell-command</var>)
</pre></div>

<p>which executes <var>shell-command</var> as a shell command.
</p>
<p>The expansion of <code>syscmd</code> is void, <em>not</em> the output from
<var>shell-command</var>!  Output or error messages from <var>shell-command</var>
are not read by <code>m4</code>.  See <a href="#Esyscmd">Esyscmd</a> if you need to process the
command output.
</p>
<p>Prior to executing the command, <code>m4</code> flushes its output buffers.
The default standard input, output and error of <var>shell-command</var> are
the same as those of <code>m4</code>.
</p>
<p>The builtin macro <code>syscmd</code> is recognized only when given arguments.
</p>
<hr>
<span id="Esyscmd"></span><div class="header">
<p>
Next: <a href="#Sysval" accesskey="n" rel="next">Sysval</a>, Previous: <a href="#Syscmd" accesskey="p" rel="prev">Syscmd</a>, Up: <a href="#UNIX-commands" accesskey="u" rel="up">UNIX commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Reading-the-output-of-commands"></span><h3 class="section">12.2 Reading the output of commands</h3>

<span id="index-esyscmd"></span>
<span id="index-GNU-extensions-10"></span>
<p>If you want <code>m4</code> to read the output of a UNIX command, use
<code>esyscmd</code>:
</p>
<div class="example">
<pre class="example">esyscmd(<var>shell-command</var>)
</pre></div>

<p>which expands to the standard output of the shell command
<var>shell-command</var>.
</p>
<p>Prior to executing the command, <code>m4</code> flushes its output buffers.
The default standard input and error output of <var>shell-command</var> are
the same as those of <code>m4</code>.  The error output of <var>shell-command</var>
is not a part of the expansion: it will appear along with the error
output of <code>m4</code>.
</p>
<p>Assume you are positioned into the <samp>checks</samp> directory of GNU
<code>m4</code> distribution, then:
</p>
<div class="example">
<pre class="example">define(`vice', `esyscmd(grep Vice ../COPYING)')
&rArr;
vice
&rArr;  Ty Coon, President of Vice
&rArr;
</pre></div>

<p>Note how the expansion of <code>esyscmd</code> has a trailing newline.
</p>
<p>The builtin macro <code>esyscmd</code> is recognized only when given
arguments.
</p>
<hr>
<span id="Sysval"></span><div class="header">
<p>
Next: <a href="#Maketemp" accesskey="n" rel="next">Maketemp</a>, Previous: <a href="#Esyscmd" accesskey="p" rel="prev">Esyscmd</a>, Up: <a href="#UNIX-commands" accesskey="u" rel="up">UNIX commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Exit-codes"></span><h3 class="section">12.3 Exit codes</h3>

<span id="index-exit-code-from-UNIX-commands"></span>
<span id="index-UNIX-commands_002c-exit-code-from"></span>
<span id="index-commands_002c-exit-code-from-UNIX"></span>
<span id="index-sysval"></span>
<p>To see whether a shell command succeeded, use <code>sysval</code>:
</p>
<div class="example">
<pre class="example">sysval
</pre></div>

<p>which expands to the exit status of the last shell command run with
<code>syscmd</code> or <code>esyscmd</code>.
</p>
<div class="example">
<pre class="example">syscmd(`false')
&rArr;
ifelse(sysval, 0, zero, non-zero)
&rArr;non-zero
syscmd(`true')
&rArr;
sysval
&rArr;0
</pre></div>

<hr>
<span id="Maketemp"></span><div class="header">
<p>
Previous: <a href="#Sysval" accesskey="p" rel="prev">Sysval</a>, Up: <a href="#UNIX-commands" accesskey="u" rel="up">UNIX commands</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Making-names-for-temporary-files"></span><h3 class="section">12.4 Making names for temporary files</h3>

<span id="index-temporary-filenames"></span>
<span id="index-files_002c-names-of-temporary"></span>
<span id="index-maketemp"></span>
<p>Commands specified to <code>syscmd</code> or <code>esyscmd</code> might need a
temporary file, for output or for some other purpose.
There is a builtin macro, <code>maketemp</code>, for making temporary file
names:
</p>
<div class="example">
<pre class="example">maketemp(<var>template</var>)
</pre></div>

<p>which expands to a name of a non-existent file, made from the string
<var>template</var>, which should end with the string &lsquo;<samp>XXXXXX</samp>&rsquo;.  The six
<code>X</code>&rsquo;s are then replaced, usually with something that includes the
process id of the <code>m4</code> process, in order to make the filename unique.
</p>
<div class="example">
<pre class="example">maketemp(`/tmp/fooXXXXXX')
&rArr;/tmp/fooa07346
maketemp(`/tmp/fooXXXXXX')
&rArr;/tmp/fooa07346
</pre></div>

<p>As seen in the example, several calls of <code>maketemp</code> might expand to
the same string, since the selection criteria is whether the file exists
or not.  If a file has not been created before the next call, the two
macro calls might expand to the same name.
</p>
<p>The builtin macro <code>maketemp</code> is recognized only when given
arguments.
</p>
<hr>
<span id="Miscellaneous"></span><div class="header">
<p>
Next: <a href="#Frozen-files" accesskey="n" rel="next">Frozen files</a>, Previous: <a href="#UNIX-commands" accesskey="p" rel="prev">UNIX commands</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Miscellaneous-builtin-macros"></span><h2 class="chapter">13 Miscellaneous builtin macros</h2>

<p>This chapter describes various builtins, that do not really belong in
any of the previous chapters.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Errprint" accesskey="1">Errprint</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Printing error messages
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#M4exit" accesskey="2">M4exit</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Exiting from m4
</td></tr>
</table>

<hr>
<span id="Errprint"></span><div class="header">
<p>
Next: <a href="#M4exit" accesskey="n" rel="next">M4exit</a>, Previous: <a href="#Miscellaneous" accesskey="p" rel="prev">Miscellaneous</a>, Up: <a href="#Miscellaneous" accesskey="u" rel="up">Miscellaneous</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Printing-error-messages"></span><h3 class="section">13.1 Printing error messages</h3>

<span id="index-printing-error-messages"></span>
<span id="index-error-messages_002c-printing"></span>
<span id="index-messages_002c-printing-error"></span>
<span id="index-errprint"></span>
<p>You can print error messages using <code>errprint</code>:
</p>
<div class="example">
<pre class="example">errprint(<var>message</var>, ...)
</pre></div>
<p>which simply prints <var>message</var> and the rest of the arguments on the
standard error output.
</p>
<p>The expansion of <code>errprint</code> is void.
</p>
<div class="example">
<pre class="example">errprint(`Illegal arguments to forloop
')
error&rarr;Illegal arguments to forloop
&rArr;
</pre></div>

<p>A trailing newline is <em>not</em> printed automatically, so it must be
supplied as part of the argument, as in the example.  (BSD flavored
<code>m4</code>&rsquo;s do append a trailing newline on each <code>errprint</code> call).
</p>
<p>To make it possible to specify the location of the error, two
utility builtins exist:
</p>
<span id="index-file"></span>
<span id="index-line"></span>
<div class="example">
<pre class="example">__file__
__line__
</pre></div>
<p>which expands to the quoted name of the current input file, and the
current input line number in that file.
</p>
<div class="example">
<pre class="example">errprint(`m4:'__file__:__line__: `Input error
')
error&rarr;m4:56.errprint:2: Input error
&rArr;
</pre></div>

<hr>
<span id="M4exit"></span><div class="header">
<p>
Previous: <a href="#Errprint" accesskey="p" rel="prev">Errprint</a>, Up: <a href="#Miscellaneous" accesskey="u" rel="up">Miscellaneous</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Exiting-from-m4"></span><h3 class="section">13.2 Exiting from <code>m4</code></h3>

<span id="index-exiting-from-m4"></span>
<span id="index-m4exit"></span>
<p>If you need to exit from <code>m4</code> before the entire input has been
read, you can use <code>m4exit</code>:
</p>
<div class="example">
<pre class="example">m4exit(opt <var>code</var>)
</pre></div>
<p>which causes <code>m4</code> to exit, with exit code <var>code</var>.  If
<var>code</var> is left out, the exit code is zero.
</p>
<div class="example">
<pre class="example">define(`fatal_error', `errprint(`m4: '__file__: __line__`: fatal error: $*
')m4exit(1)')
&rArr;
fatal_error(`This is a BAD one, buster')
error&rarr;m4: 57.m4exit: 5: fatal error: This is a BAD one, buster
</pre></div>

<p>After this macro call, <code>m4</code> will exit with exit code 1.  This macro
is only intended for error exits, since the normal exit procedures are
not followed, e.g., diverted text is not undiverted, and saved text
(see <a href="#M4wrap">M4wrap</a>) is not reread.
</p>
<hr>
<span id="Frozen-files"></span><div class="header">
<p>
Next: <a href="#Compatibility" accesskey="n" rel="next">Compatibility</a>, Previous: <a href="#Miscellaneous" accesskey="p" rel="prev">Miscellaneous</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Fast-loading-of-frozen-states"></span><h2 class="chapter">14 Fast loading of frozen states</h2>

<span id="index-fast-loading-of-frozen-files"></span>
<span id="index-frozen-files-for-fast-loading"></span>
<span id="index-initialization_002c-frozen-states"></span>
<span id="index-dumping-into-frozen-file"></span>
<span id="index-reloading-a-frozen-file"></span>
<span id="index-GNU-extensions-11"></span>
<p>Some bigger <code>m4</code> applications may be built over a common base
containing hundreds of definitions and other costly initializations.
Usually, the common base is kept in one or more declarative files,
which files are listed on each <code>m4</code> invocation prior to the
user&rsquo;s input file, or else, <code>include</code>&rsquo;d from this input file.
</p>
<p>Reading the common base of a big application, over and over again, may
be time consuming.  GNU <code>m4</code> offers some machinery to speed up
the start of an application using lengthy common bases.  Presume the
user repeatedly uses:
</p>
<div class="example">
<pre class="example">m4 base.m4 input.m4
</pre></div>

<p>with a varying contents of <samp>input.m4</samp>, but a rather fixed contents
for <samp>base.m4</samp>.  Then, the user might rather execute:
</p>
<div class="example">
<pre class="example">m4 -F base.m4f base.m4
</pre></div>

<p>once, and further execute, as often as needed:
</p>
<div class="example">
<pre class="example">m4 -R base.m4f input.m4
</pre></div>

<p>with the varying input.  The first call, containing the <code>-F</code>
option, only reads and executes file <samp>base.m4</samp>, so defining
various application macros and computing other initializations.  Only
once the input file <samp>base.m4</samp> has been completely processed, GNU
<code>m4</code> produces on <samp>base.m4f</samp> a <em>frozen</em> file, that is, a
file which contains a kind of snapshot of the <code>m4</code> internal state.
</p>
<p>Later calls, containing the <code>-R</code> option, are able to reload
the internal state of <code>m4</code>&rsquo;s memory, from <samp>base.m4f</samp>,
<em>prior</em> to reading any other input files.  By this mean,
instead of starting with a virgin copy of <code>m4</code>, input will be
read after having effectively recovered the effect of a prior run.
In our example, the effect is the same as if file <samp>base.m4</samp> has
been read anew.  However, this effect is achieved a lot faster.
</p>
<p>Only one frozen file may be created or read in any one <code>m4</code>
invocation.  It is not possible to recover two frozen files at once.
However, frozen files may be updated incrementally, through using
<code>-R</code> and <code>-F</code> options simultaneously.  For example, if
some care is taken, the command:
</p>
<div class="example">
<pre class="example">m4 file1.m4 file2.m4 file3.m4 file4.m4
</pre></div>

<p>could be broken down in the following sequence, accumulating the same
output:
</p>
<div class="example">
<pre class="example">m4 -F file1.m4f file1.m4
m4 -R file1.m4f -F file2.m4f file2.m4
m4 -R file2.m4f -F file3.m4f file3.m4
m4 -R file3.m4f file4.m4
</pre></div>

<p>Some care is necessary because not every effort has been made for
this to work in all cases.  In particular, the trace attribute of
macros is not handled, nor the current setting of <code>changeword</code>.
Also, interactions for some options of <code>m4</code> being used in one call
and not for the next, have not been fully analyzed yet.  On the other
end, you may be confident that stacks of <code>pushdef</code>&rsquo;ed definitions
are handled correctly, so are <code>undefine</code>&rsquo;d or renamed builtins,
changed strings for quotes or comments.
</p>
<p>When an <code>m4</code> run is to be frozen, the automatic undiversion
which takes place at end of execution is inhibited.  Instead, all
positively numbered diversions are saved into the frozen file.
The active diversion number is also transmitted.
</p>
<p>A frozen file to be reloaded need not reside in the current directory.
It is looked up the same way as an <code>include</code> file (see <a href="#Search-Path">Search Path</a>).
</p>
<p>Frozen files are sharable across architectures.  It is safe to write
a frozen file one one machine and read it on another, given that the
second machine uses the same, or a newer version of GNU <code>m4</code>.
These are simple (editable) text files, made up of directives,
each starting with a capital letter and ending with a newline
(<tt class="key">NL</tt>).  Wherever a directive is expected, the character
<kbd>#</kbd> introduces a comment line, empty lines are also ignored.
In the following descriptions, <var>length</var>s always refer to
corresponding <var>string</var>s.  Numbers are always expressed in decimal.
The directives are:
</p>
<dl compact="compact">
<dt><code>V <var>number</var> <span class="key">NL</span></code></dt>
<dd><p>Confirms the format of the file.  <var>number</var> should be 1.
</p>
</dd>
<dt><code>C <var>length1</var> , <var>length2</var> <span class="key">NL</span> <var>string1</var> <var>string2</var> <span class="key">NL</span></code></dt>
<dd><p>Uses <var>string1</var> and <var>string2</var> as the beginning comment and
end comment strings.
</p>
</dd>
<dt><code>Q <var>length1</var> , <var>length2</var> <span class="key">NL</span> <var>string1</var> <var>string2</var> <span class="key">NL</span></code></dt>
<dd><p>Uses <var>string1</var> and <var>string2</var> as the beginning quote and end quote
strings.
</p>
</dd>
<dt><code>F <var>length1</var> , <var>length2</var> <span class="key">NL</span> <var>string1</var> <var>string2</var> <span class="key">NL</span></code></dt>
<dd><p>Defines, through <code>pushdef</code>, a definition for <var>string1</var>
expanding to the function whose builtin name is <var>string2</var>.
</p>
</dd>
<dt><code>T <var>length1</var> , <var>length2</var> <span class="key">NL</span> <var>string1</var> <var>string2</var> <span class="key">NL</span></code></dt>
<dd><p>Defines, though <code>pushdef</code>, a definition for <var>string1</var>
expanding to the text given by <var>string2</var>.
</p>
</dd>
<dt><code>D <var>number</var>, <var>length</var> <span class="key">NL</span> <var>string</var> <span class="key">NL</span></code></dt>
<dd><p>Selects diversion <var>number</var>, making it current, then copy
<var>string</var> in the current diversion.  <var>number</var> may be a negative
number for a non-existing diversion.  To merely specify an active
selection, use this command with an empty <var>string</var>.  With 0 as the
diversion <var>number</var>, <var>string</var> will be issued on standard output
at reload time, however this may not be produced from within <code>m4</code>.
</p>
</dd>
</dl>

<hr>
<span id="Compatibility"></span><div class="header">
<p>
Next: <a href="#Concept-index" accesskey="n" rel="next">Concept index</a>, Previous: <a href="#Frozen-files" accesskey="p" rel="prev">Frozen files</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Compatibility-with-other-versions-of-m4"></span><h2 class="chapter">15 Compatibility with other versions of <code>m4</code></h2>

<span id="index-compatibility"></span>
<p>This chapter describes the differences between this implementation of
<code>m4</code>, and the implementation found under UNIX, notably System V,
Release 3.  
</p>
<p>There are also differences in BSD flavors of <code>m4</code>.  No attempt
is made to summarize these here.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Extensions" accesskey="1">Extensions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Extensions in GNU m4
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Incompatibilities" accesskey="2">Incompatibilities</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Facilities in System V m4 not in GNU m4
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Other-Incompat" accesskey="3">Other Incompat</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">Other incompatibilities
</td></tr>
</table>

<hr>
<span id="Extensions"></span><div class="header">
<p>
Next: <a href="#Incompatibilities" accesskey="n" rel="next">Incompatibilities</a>, Previous: <a href="#Compatibility" accesskey="p" rel="prev">Compatibility</a>, Up: <a href="#Compatibility" accesskey="u" rel="up">Compatibility</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Extensions-in-GNU-m4"></span><h3 class="section">15.1 Extensions in GNU <code>m4</code></h3>

<span id="index-GNU-extensions-12"></span>
<p>This version of <code>m4</code> contains a few facilities, that do not exist
in System V <code>m4</code>.  These extra facilities are all suppressed by
using the &lsquo;<samp>-G</samp>&rsquo; command line option, unless overridden by other
command line options.
</p>
<ul>
<li> In the <code>$</code><var>n</var> notation for macro arguments, <var>n</var> can contain
several digits, while the System V <code>m4</code> only accepts one digit.
This allows macros in GNU <code>m4</code> to take any number of arguments, and
not only nine (see <a href="#Arguments">Arguments</a>).

</li><li> Files included with <code>include</code> and <code>sinclude</code> are sought in a
user specified search path, if they are not found in the working
directory.  The search path is specified by the &lsquo;<samp>-I</samp>&rsquo; option and the
&lsquo;<samp>M4PATH</samp>&rsquo; environment variable (see <a href="#Search-Path">Search Path</a>).

</li><li> Arguments to <code>undivert</code> can be non-numeric, in which case the named
file will be included uninterpreted in the output (see <a href="#Undivert">Undivert</a>).

</li><li> Formatted output is supported through the <code>format</code> builtin, which
is modeled after the C library function <code>printf</code> (see <a href="#Format">Format</a>).

</li><li> Searches and text substitution through regular expressions are
supported by the <code>regexp</code> (see <a href="#Regexp">Regexp</a>) and <code>patsubst</code>
(see <a href="#Patsubst">Patsubst</a>) builtins.

</li><li> The output of shell commands can be read into <code>m4</code> with
<code>esyscmd</code> (see <a href="#Esyscmd">Esyscmd</a>).

</li><li> There is indirect access to any builtin macro with <code>builtin</code>
(see <a href="#Builtin">Builtin</a>).

</li><li> Macros can be called indirectly through <code>indir</code> (see <a href="#Indir">Indir</a>).

</li><li> The name of the current input file and the current input line number are
accessible through the builtins <code>__file__</code> and <code>__line__</code>
(see <a href="#Errprint">Errprint</a>).

</li><li> The format of the output from <code>dumpdef</code> and macro tracing can be
controlled with <code>debugmode</code> (see <a href="#Debug-Levels">Debug Levels</a>).

</li><li> The destination of trace and debug output can be controlled with
<code>debugfile</code> (see <a href="#Debug-Output">Debug Output</a>).
</li></ul>

<p>In addition to the above extensions, GNU <code>m4</code> implements the
following command line options: &lsquo;<samp>-F</samp>&rsquo;, &lsquo;<samp>-G</samp>&rsquo;, &lsquo;<samp>-I</samp>&rsquo;,
&lsquo;<samp>-L</samp>&rsquo;, &lsquo;<samp>-R</samp>&rsquo;, &lsquo;<samp>-V</samp>&rsquo;, &lsquo;<samp>-W</samp>&rsquo;, &lsquo;<samp>-d</samp>&rsquo;,
&lsquo;<samp>-l</samp>&rsquo;, &lsquo;<samp>-o</samp>&rsquo; and &lsquo;<samp>-t</samp>&rsquo;.  See <a href="#Invoking-m4">Invoking m4</a>, for a
description of these options.
</p>
<p>Also, the debugging and tracing facilities in GNU <code>m4</code> are much
more extensive than in most other versions of <code>m4</code>.
</p>
<hr>
<span id="Incompatibilities"></span><div class="header">
<p>
Next: <a href="#Other-Incompat" accesskey="n" rel="next">Other Incompat</a>, Previous: <a href="#Extensions" accesskey="p" rel="prev">Extensions</a>, Up: <a href="#Compatibility" accesskey="u" rel="up">Compatibility</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Facilities-in-System-V-m4-not-in-GNU-m4"></span><h3 class="section">15.2 Facilities in System V <code>m4</code> not in GNU <code>m4</code></h3>

<p>The version of <code>m4</code> from System V contains a few facilities that
have not been implemented in GNU <code>m4</code> yet.
</p>
<ul>
<li> System V <code>m4</code> supports multiple arguments to <code>defn</code>.  This is
not implemented in GNU <code>m4</code>.  Its usefulness is unclear to me.
</li></ul>

<hr>
<span id="Other-Incompat"></span><div class="header">
<p>
Previous: <a href="#Incompatibilities" accesskey="p" rel="prev">Incompatibilities</a>, Up: <a href="#Compatibility" accesskey="u" rel="up">Compatibility</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Other-incompatibilities"></span><h3 class="section">15.3 Other incompatibilities</h3>

<p>There are a few other incompatibilities between this implementation of
<code>m4</code>, and the System V version.
</p>
<ul>
<li> GNU <code>m4</code> implements sync lines differently from System V <code>m4</code>,
when text is being diverted.  GNU <code>m4</code> outputs the sync lines when
the text is being diverted, and System V <code>m4</code> when the diverted
text is being brought back.

<p>The problem is which lines and filenames should be attached to text that
is being, or has been, diverted.  System V <code>m4</code> regards all the
diverted text as being generated by the source line containing the
<code>undivert</code> call, whereas GNU <code>m4</code> regards the diverted text as
being generated at the time it is diverted.
</p>
<p>I expect the sync line option to be used mostly when using <code>m4</code> as
a front end to a compiler.  If a diverted line causes a compiler error,
the error messages should most probably refer to the place where the
diversion were made, and not where it was inserted again.
</p>
</li><li> GNU <code>m4</code> makes no attempt at prohiting autoreferential definitions
like:

<div class="example">
<pre class="example">define(`x', `x')
define(`x', `x ')
</pre></div>

<p>There is nothing inherently wrong with defining &lsquo;<samp>x</samp>&rsquo; to
return &lsquo;<samp>x</samp>&rsquo;.  The wrong thing is to expand &lsquo;<samp>x</samp>&rsquo; unquoted.
In <code>m4</code>, one might use macros to hold strings, as we do for
variables in other programming languages, further checking them with:
</p>
<div class="example">
<pre class="example">ifelse(defn(`<var>holder</var>'), `<var>value</var>', &hellip;)
</pre></div>

<p>In cases like this one, an interdiction for a macro to hold its own
name would be a useless limitation.  Of course, this leave more rope
for the GNU <code>m4</code> user to hang himself!  Rescanning hangs may be
avoided through careful programming, a little like for endless loops
in traditional programming languages.
</p>
</li><li> <span id="index-gnu"></span>
GNU <code>m4</code> without &lsquo;<samp>-G</samp>&rsquo; option will define the macro
<code>__gnu__</code> to expand to the empty string.

<span id="index-unix"></span>
<p>On UNIX systems, GNU <code>m4</code> without the &lsquo;<samp>-G</samp>&rsquo; option will define
the macro <code>__unix__</code>, otherwise the macro <code>unix</code>.  Both will
expand to the empty string.
</p></li></ul>

<hr>
<span id="Concept-index"></span><div class="header">
<p>
Next: <a href="#Macro-index" accesskey="n" rel="next">Macro index</a>, Previous: <a href="#Compatibility" accesskey="p" rel="prev">Compatibility</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Concept-index-1"></span><h2 class="unnumbered">Concept index</h2>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Concept-index_cp_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-Q"><b>Q</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-W"><b>W</b></a>
 &nbsp; 
</td></tr></table>
<table class="index-cp" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-A">A</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-arguments-to-macros">arguments to macros</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Macro-Arguments">Macro Arguments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Arguments-to-macros">Arguments to macros</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Arguments">Arguments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-arguments-to-macros_002c-special">arguments to macros, special</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pseudo-Arguments">Pseudo Arguments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-arguments_002c-quoted-macro">arguments, quoted macro</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Quoting-Arguments">Quoting Arguments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-arithmetic">arithmetic</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Arithmetic">Arithmetic</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-B">B</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-builtins_002c-indirect-call-of">builtins, indirect call of</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Builtin">Builtin</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-C">C</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-call-of-builtins_002c-indirect">call of builtins, indirect</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Builtin">Builtin</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-call-of-macros_002c-indirect">call of macros, indirect</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Indir">Indir</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-changing-comment-delimiters">changing comment delimiters</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Changecom">Changecom</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-changing-the-quote-delimiters">changing the quote delimiters</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Changequote">Changequote</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-characters_002c-translating">characters, translating</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Translit">Translit</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-command-line_002c-filenames-on-the">command line, filenames on the</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Invoking-m4">Invoking m4</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-command-line_002c-macro-definitions-on-the">command line, macro definitions on the</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Invoking-m4">Invoking m4</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-command-line_002c-options">command line, options</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Invoking-m4">Invoking m4</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-commands_002c-exit-code-from-UNIX">commands, exit code from UNIX</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Sysval">Sysval</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-commands_002c-running-UNIX">commands, running UNIX</a>:</td><td>&nbsp;</td><td valign="top"><a href="#UNIX-commands">UNIX commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-comment-delimiters_002c-changing">comment delimiters, changing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Changecom">Changecom</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-comments">comments</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Comments">Comments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-comments_002c-copied-to-output">comments, copied to output</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Changecom">Changecom</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-comparing-strings">comparing strings</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Ifelse">Ifelse</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-compatibility">compatibility</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Compatibility">Compatibility</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-conditionals">conditionals</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Ifdef">Ifdef</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-controlling-debugging-output">controlling debugging output</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Levels">Debug Levels</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-counting-loops">counting loops</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Loops">Loops</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-D">D</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-debugging-output_002c-controlling">debugging output, controlling</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Levels">Debug Levels</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-debugging-output_002c-saving">debugging output, saving</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Output">Debug Output</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-decrement-operator">decrement operator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Incr">Incr</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-defining-new-macros">defining new macros</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Definitions">Definitions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-definitions_002c-displaying-macro">definitions, displaying macro</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Dumpdef">Dumpdef</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-deleting-macros">deleting macros</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Undefine">Undefine</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-deleting-whitespace-in-input">deleting whitespace in input</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Dnl">Dnl</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-discarding-diverted-text">discarding diverted text</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cleardiv">Cleardiv</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-displaying-macro-definitions">displaying macro definitions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Dumpdef">Dumpdef</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-diversion-numbers">diversion numbers</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Divnum">Divnum</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-diverted-text_002c-discarding">diverted text, discarding</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Cleardiv">Cleardiv</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-diverting-output-to-files">diverting output to files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Divert">Divert</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dumping-into-frozen-file">dumping into frozen file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Frozen-files">Frozen files</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-E">E</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-error-messages_002c-printing">error messages, printing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Errprint">Errprint</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-evaluation_002c-of-integer-expressions">evaluation, of integer expressions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Eval">Eval</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-executing-UNIX-commands">executing UNIX commands</a>:</td><td>&nbsp;</td><td valign="top"><a href="#UNIX-commands">UNIX commands</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-exit-code-from-UNIX-commands">exit code from UNIX commands</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Sysval">Sysval</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-exiting-from-m4">exiting from <code>m4</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#M4exit">M4exit</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-expansion-of-macros">expansion of macros</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Macro-expansion">Macro expansion</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-expansion_002c-tracing-macro">expansion, tracing macro</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Trace">Trace</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-expressions_002c-evaluation-of-integer">expressions, evaluation of integer</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Eval">Eval</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-extracting-substrings">extracting substrings</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Substr">Substr</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-F">F</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-fast-loading-of-frozen-files">fast loading of frozen files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Frozen-files">Frozen files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-file-inclusion">file inclusion</a>:</td><td>&nbsp;</td><td valign="top"><a href="#File-Inclusion">File Inclusion</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-file-inclusion-1">file inclusion</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Undivert">Undivert</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-filenames_002c-on-the-command-line">filenames, on the command line</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Invoking-m4">Invoking m4</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-files_002c-diverting-output-to">files, diverting output to</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Divert">Divert</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-files_002c-names-of-temporary">files, names of temporary</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Maketemp">Maketemp</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-forloops">forloops</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Loops">Loops</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-formatted-output">formatted output</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Format">Format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-frozen-files-for-fast-loading">frozen files for fast loading</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Frozen-files">Frozen files</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-G">G</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-GNU-extensions">GNU extensions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Arguments">Arguments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GNU-extensions-1">GNU extensions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Indir">Indir</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GNU-extensions-2">GNU extensions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Builtin">Builtin</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GNU-extensions-3">GNU extensions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Levels">Debug Levels</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GNU-extensions-4">GNU extensions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Output">Debug Output</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GNU-extensions-5">GNU extensions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Search-Path">Search Path</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GNU-extensions-6">GNU extensions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Undivert">Undivert</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GNU-extensions-7">GNU extensions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Regexp">Regexp</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GNU-extensions-8">GNU extensions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Patsubst">Patsubst</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GNU-extensions-9">GNU extensions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Format">Format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GNU-extensions-10">GNU extensions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Esyscmd">Esyscmd</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GNU-extensions-11">GNU extensions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Frozen-files">Frozen files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-GNU-extensions-12">GNU extensions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Extensions">Extensions</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-I">I</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-included-files_002c-search-path-for">included files, search path for</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Search-Path">Search Path</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-inclusion_002c-of-files">inclusion, of files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#File-Inclusion">File Inclusion</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-inclusion_002c-of-files-1">inclusion, of files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Undivert">Undivert</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-increment-operator">increment operator</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Incr">Incr</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-indirect-call-of-builtins">indirect call of builtins</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Builtin">Builtin</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-indirect-call-of-macros">indirect call of macros</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Indir">Indir</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-initialization_002c-frozen-states">initialization, frozen states</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Frozen-files">Frozen files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-input-tokens">input tokens</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Syntax">Syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-input_002c-saving">input, saving</a>:</td><td>&nbsp;</td><td valign="top"><a href="#M4wrap">M4wrap</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-integer-arithmetic">integer arithmetic</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Arithmetic">Arithmetic</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-integer-expression-evaluation">integer expression evaluation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Eval">Eval</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-L">L</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-length-of-strings">length of strings</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Len">Len</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-lexical-structure-of-words">lexical structure of words</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Changeword">Changeword</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-loops">loops</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Loops">Loops</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-loops_002c-counting">loops, counting</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Loops">Loops</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-M">M</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-macro-definitions_002c-on-the-command-line">macro definitions, on the command line</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Invoking-m4">Invoking m4</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macro-expansion_002c-tracing">macro expansion, tracing</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Trace">Trace</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macro-invocation">macro invocation</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Invocation">Invocation</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macros_002c-arguments-to">macros, arguments to</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Macro-Arguments">Macro Arguments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macros_002c-arguments-to-1">macros, arguments to</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Arguments">Arguments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macros_002c-displaying-definitions">macros, displaying definitions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Dumpdef">Dumpdef</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macros_002c-expansion-of">macros, expansion of</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Macro-expansion">Macro expansion</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macros_002c-how-to-define-new">macros, how to define new</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Definitions">Definitions</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macros_002c-how-to-delete">macros, how to delete</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Undefine">Undefine</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macros_002c-how-to-rename">macros, how to rename</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Defn">Defn</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macros_002c-indirect-call-of">macros, indirect call of</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Indir">Indir</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macros_002c-quoted-arguments-to">macros, quoted arguments to</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Quoting-Arguments">Quoting Arguments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macros_002c-recursive">macros, recursive</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Loops">Loops</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macros_002c-special-arguments-to">macros, special arguments to</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pseudo-Arguments">Pseudo Arguments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-macros_002c-temporary-redefinition-of">macros, temporary redefinition of</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pushdef">Pushdef</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-messages_002c-printing-error">messages, printing error</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Errprint">Errprint</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-multibranches">multibranches</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Ifelse">Ifelse</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-N">N</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-names">names</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Names">Names</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-O">O</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-options_002c-command-line">options, command line</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Invoking-m4">Invoking m4</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-output_002c-diverting-to-files">output, diverting to files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Divert">Divert</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-output_002c-formatted">output, formatted</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Format">Format</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-output_002c-saving-debugging">output, saving debugging</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Output">Debug Output</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-P">P</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-pattern-substitution">pattern substitution</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Patsubst">Patsubst</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-printing-error-messages">printing error messages</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Errprint">Errprint</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-Q">Q</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-quote-delimiters_002c-changing-the">quote delimiters, changing the</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Changequote">Changequote</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-quoted-macro-arguments">quoted macro arguments</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Quoting-Arguments">Quoting Arguments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-quoted-string">quoted string</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Quoted-strings">Quoted strings</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-R">R</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-recursive-macros">recursive macros</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Loops">Loops</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-redefinition-of-macros_002c-temporary">redefinition of macros, temporary</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pushdef">Pushdef</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-regular-expressions">regular expressions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Regexp">Regexp</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-regular-expressions-1">regular expressions</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Patsubst">Patsubst</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-reloading-a-frozen-file">reloading a frozen file</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Frozen-files">Frozen files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-renaming-macros">renaming macros</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Defn">Defn</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-running-UNIX-commands">running UNIX commands</a>:</td><td>&nbsp;</td><td valign="top"><a href="#UNIX-commands">UNIX commands</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-S">S</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-saving-debugging-output">saving debugging output</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Output">Debug Output</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-saving-input">saving input</a>:</td><td>&nbsp;</td><td valign="top"><a href="#M4wrap">M4wrap</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-search-path-for-included-files">search path for included files</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Search-Path">Search Path</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-special-arguments-to-macros">special arguments to macros</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pseudo-Arguments">Pseudo Arguments</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-strings_002c-length-of">strings, length of</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Len">Len</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-substitution-by-regular-expression">substitution by regular expression</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Patsubst">Patsubst</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-substrings_002c-extracting">substrings, extracting</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Substr">Substr</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-T">T</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-temporary-filenames">temporary filenames</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Maketemp">Maketemp</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-temporary-redefinition-of-macros">temporary redefinition of macros</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pushdef">Pushdef</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tokens">tokens</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Syntax">Syntax</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tracing-macro-expansion">tracing macro expansion</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Trace">Trace</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-translating-characters">translating characters</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Translit">Translit</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-U">U</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-undefining-macros">undefining macros</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Undefine">Undefine</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-UNIX-commands_002c-exit-code-from">UNIX commands, exit code from</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Sysval">Sysval</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-UNIX-commands_002c-running">UNIX commands, running</a>:</td><td>&nbsp;</td><td valign="top"><a href="#UNIX-commands">UNIX commands</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Concept-index_cp_letter-W">W</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-words_002c-lexical-structure-of">words, lexical structure of</a>:</td><td>&nbsp;</td><td valign="top"><a href="#Changeword">Changeword</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Concept-index_cp_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-Q"><b>Q</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-index_cp_letter-W"><b>W</b></a>
 &nbsp; 
</td></tr></table>

<hr>
<span id="Macro-index"></span><div class="header">
<p>
Previous: <a href="#Concept-index" accesskey="p" rel="prev">Concept index</a>, Up: <a href="#Top" accesskey="u" rel="up">Top</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="#Concept-index" title="Index" rel="index">Index</a>]</p>
</div>
<span id="Macro-index-1"></span><h2 class="unnumbered">Macro index</h2>

<p>References are exclusively to the places where a builtin is introduced
the first time.  Names starting and ending with &lsquo;<samp>__</samp>&rsquo; have these
characters removed in the index.
</p>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Macro-index_fn_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-U"><b>U</b></a>
 &nbsp; 
</td></tr></table>
<table class="index-fn" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Macro-index_fn_letter-B">B</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-builtin"><code>builtin</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Builtin">Builtin</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Macro-index_fn_letter-C">C</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-changecom"><code>changecom</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Changecom">Changecom</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-changequote"><code>changequote</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Changequote">Changequote</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-changeword"><code>changeword</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Changeword">Changeword</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Macro-index_fn_letter-D">D</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-debugfile"><code>debugfile</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Output">Debug Output</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-debugmode"><code>debugmode</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Debug-Levels">Debug Levels</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-decr"><code>decr</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Incr">Incr</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-define"><code>define</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Define">Define</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-defn"><code>defn</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Defn">Defn</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-divert"><code>divert</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Divert">Divert</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-divnum"><code>divnum</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Divnum">Divnum</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dnl"><code>dnl</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Dnl">Dnl</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dumpdef"><code>dumpdef</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Dumpdef">Dumpdef</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Macro-index_fn_letter-E">E</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-errprint"><code>errprint</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Errprint">Errprint</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-esyscmd"><code>esyscmd</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Esyscmd">Esyscmd</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-eval"><code>eval</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Eval">Eval</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Macro-index_fn_letter-F">F</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-file"><code>file</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Errprint">Errprint</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-format"><code>format</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Format">Format</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Macro-index_fn_letter-G">G</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-gnu"><code>gnu</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Other-Incompat">Other Incompat</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Macro-index_fn_letter-I">I</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-ifdef"><code>ifdef</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Ifdef">Ifdef</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ifelse"><code>ifelse</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Ifelse">Ifelse</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-include"><code>include</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Include">Include</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-incr"><code>incr</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Incr">Incr</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-index"><code>index</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Index">Index</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-indir"><code>indir</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Indir">Indir</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Macro-index_fn_letter-L">L</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-len"><code>len</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Len">Len</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-line"><code>line</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Errprint">Errprint</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Macro-index_fn_letter-M">M</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-m4exit"><code>m4exit</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#M4exit">M4exit</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-m4wrap"><code>m4wrap</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#M4wrap">M4wrap</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-maketemp"><code>maketemp</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Maketemp">Maketemp</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Macro-index_fn_letter-P">P</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-patsubst"><code>patsubst</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Patsubst">Patsubst</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-popdef"><code>popdef</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pushdef">Pushdef</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pushdef"><code>pushdef</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Pushdef">Pushdef</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Macro-index_fn_letter-R">R</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-regexp"><code>regexp</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Regexp">Regexp</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Macro-index_fn_letter-S">S</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-shift"><code>shift</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Loops">Loops</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sinclude"><code>sinclude</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Include">Include</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-substr"><code>substr</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Substr">Substr</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-syscmd"><code>syscmd</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Syscmd">Syscmd</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sysval"><code>sysval</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Sysval">Sysval</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Macro-index_fn_letter-T">T</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-traceoff"><code>traceoff</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Trace">Trace</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-traceon"><code>traceon</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Trace">Trace</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-translit"><code>translit</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Translit">Translit</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th id="Macro-index_fn_letter-U">U</th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-undefine"><code>undefine</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Undefine">Undefine</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-undivert"><code>undivert</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Undivert">Undivert</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-unix"><code>unix</code></a>:</td><td>&nbsp;</td><td valign="top"><a href="#Other-Incompat">Other Incompat</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Macro-index_fn_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-I"><b>I</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Macro-index_fn_letter-U"><b>U</b></a>
 &nbsp; 
</td></tr></table>

<span id="SEC_Overview"></span>
<h2 class="shortcontents-heading">Short Table of Contents</h2>

<div class="shortcontents">
<ul class="no-bullet">
<li><a id="stoc-Introduction-and-preliminaries" href="#toc-Introduction-and-preliminaries">1 Introduction and preliminaries</a></li>
<li><a id="stoc-Lexical-and-syntactic-conventions" href="#toc-Lexical-and-syntactic-conventions">2 Lexical and syntactic conventions</a></li>
<li><a id="stoc-How-to-invoke-macros" href="#toc-How-to-invoke-macros">3 How to invoke macros</a></li>
<li><a id="stoc-How-to-define-new-macros" href="#toc-How-to-define-new-macros">4 How to define new macros</a></li>
<li><a id="stoc-Conditionals_002c-loops-and-recursion" href="#toc-Conditionals_002c-loops-and-recursion">5 Conditionals, loops and recursion</a></li>
<li><a id="stoc-How-to-debug-macros-and-input" href="#toc-How-to-debug-macros-and-input">6 How to debug macros and input</a></li>
<li><a id="stoc-Input-control" href="#toc-Input-control">7 Input control</a></li>
<li><a id="stoc-File-inclusion" href="#toc-File-inclusion">8 File inclusion</a></li>
<li><a id="stoc-Diverting-and-undiverting-output" href="#toc-Diverting-and-undiverting-output">9 Diverting and undiverting output</a></li>
<li><a id="stoc-Macros-for-text-handling" href="#toc-Macros-for-text-handling">10 Macros for text handling</a></li>
<li><a id="stoc-Macros-for-doing-arithmetic" href="#toc-Macros-for-doing-arithmetic">11 Macros for doing arithmetic</a></li>
<li><a id="stoc-Running-UNIX-commands" href="#toc-Running-UNIX-commands">12 Running UNIX commands</a></li>
<li><a id="stoc-Miscellaneous-builtin-macros" href="#toc-Miscellaneous-builtin-macros">13 Miscellaneous builtin macros</a></li>
<li><a id="stoc-Fast-loading-of-frozen-states" href="#toc-Fast-loading-of-frozen-states">14 Fast loading of frozen states</a></li>
<li><a id="stoc-Compatibility-with-other-versions-of-m4" href="#toc-Compatibility-with-other-versions-of-m4">15 Compatibility with other versions of <code>m4</code></a></li>
<li><a id="stoc-Concept-index-1" href="#toc-Concept-index-1" rel="index">Concept index</a></li>
<li><a id="stoc-Macro-index-1" href="#toc-Macro-index-1" rel="index">Macro index</a></li>
</ul>
</div>

<span id="SEC_Contents"></span>
<h2 class="contents-heading">Table of Contents</h2>

<div class="contents">

<ul class="no-bullet">
  <li><a id="toc-Introduction-and-preliminaries" href="#Preliminaries">1 Introduction and preliminaries</a>
  <ul class="no-bullet">
    <li><a id="toc-Introduction-to-m4" href="#Intro">1.1 Introduction to <code>m4</code></a></li>
    <li><a id="toc-Historical-references" href="#History">1.2 Historical references</a></li>
    <li><a id="toc-Invoking-m4-1" href="#Invoking-m4">1.3 Invoking <code>m4</code></a></li>
    <li><a id="toc-Problems-and-bugs" href="#Bugs">1.4 Problems and bugs</a></li>
    <li><a id="toc-Using-this-manual" href="#Manual">1.5 Using this manual</a></li>
  </ul></li>
  <li><a id="toc-Lexical-and-syntactic-conventions" href="#Syntax">2 Lexical and syntactic conventions</a>
  <ul class="no-bullet">
    <li><a id="toc-Names-1" href="#Names">2.1 Names</a></li>
    <li><a id="toc-Quoted-strings-1" href="#Quoted-strings">2.2 Quoted strings</a></li>
    <li><a id="toc-Other-tokens-1" href="#Other-tokens">2.3 Other tokens</a></li>
    <li><a id="toc-Comments-1" href="#Comments">2.4 Comments</a></li>
  </ul></li>
  <li><a id="toc-How-to-invoke-macros" href="#Macros">3 How to invoke macros</a>
  <ul class="no-bullet">
    <li><a id="toc-Macro-invocation" href="#Invocation">3.1 Macro invocation</a></li>
    <li><a id="toc-Preventing-macro-invocation" href="#Inhibiting-Invocation">3.2 Preventing macro invocation</a></li>
    <li><a id="toc-Macro-arguments" href="#Macro-Arguments">3.3 Macro arguments</a></li>
    <li><a id="toc-Quoting-macro-arguments" href="#Quoting-Arguments">3.4 Quoting macro arguments</a></li>
    <li><a id="toc-Macro-expansion-1" href="#Macro-expansion">3.5 Macro expansion</a></li>
  </ul></li>
  <li><a id="toc-How-to-define-new-macros" href="#Definitions">4 How to define new macros</a>
  <ul class="no-bullet">
    <li><a id="toc-Defining-a-macro" href="#Define">4.1 Defining a macro</a></li>
    <li><a id="toc-Arguments-to-macros" href="#Arguments">4.2 Arguments to macros</a></li>
    <li><a id="toc-Special-arguments-to-macros" href="#Pseudo-Arguments">4.3 Special arguments to macros</a></li>
    <li><a id="toc-Deleting-a-macro" href="#Undefine">4.4 Deleting a macro</a></li>
    <li><a id="toc-Renaming-macros" href="#Defn">4.5 Renaming macros</a></li>
    <li><a id="toc-Temporarily-redefining-macros" href="#Pushdef">4.6 Temporarily redefining macros</a></li>
    <li><a id="toc-Indirect-call-of-macros" href="#Indir">4.7 Indirect call of macros</a></li>
    <li><a id="toc-Indirect-call-of-builtins" href="#Builtin">4.8 Indirect call of builtins</a></li>
  </ul></li>
  <li><a id="toc-Conditionals_002c-loops-and-recursion" href="#Conditionals">5 Conditionals, loops and recursion</a>
  <ul class="no-bullet">
    <li><a id="toc-Testing-macro-definitions" href="#Ifdef">5.1 Testing macro definitions</a></li>
    <li><a id="toc-Comparing-strings" href="#Ifelse">5.2 Comparing strings</a></li>
    <li><a id="toc-Loops-and-recursion" href="#Loops">5.3 Loops and recursion</a></li>
  </ul></li>
  <li><a id="toc-How-to-debug-macros-and-input" href="#Debugging">6 How to debug macros and input</a>
  <ul class="no-bullet">
    <li><a id="toc-Displaying-macro-definitions" href="#Dumpdef">6.1 Displaying macro definitions</a></li>
    <li><a id="toc-Tracing-macro-calls" href="#Trace">6.2 Tracing macro calls</a></li>
    <li><a id="toc-Controlling-debugging-output" href="#Debug-Levels">6.3 Controlling debugging output</a></li>
    <li><a id="toc-Saving-debugging-output" href="#Debug-Output">6.4 Saving debugging output</a></li>
  </ul></li>
  <li><a id="toc-Input-control" href="#Input-Control">7 Input control</a>
  <ul class="no-bullet">
    <li><a id="toc-Deleting-whitespace-in-input" href="#Dnl">7.1 Deleting whitespace in input</a></li>
    <li><a id="toc-Changing-the-quote-characters" href="#Changequote">7.2 Changing the quote characters</a></li>
    <li><a id="toc-Changing-comment-delimiters" href="#Changecom">7.3 Changing comment delimiters</a></li>
    <li><a id="toc-Changing-the-lexical-structure-of-words" href="#Changeword">7.4 Changing the lexical structure of words</a></li>
    <li><a id="toc-Saving-input" href="#M4wrap">7.5 Saving input</a></li>
  </ul></li>
  <li><a id="toc-File-inclusion" href="#File-Inclusion">8 File inclusion</a>
  <ul class="no-bullet">
    <li><a id="toc-Including-named-files" href="#Include">8.1 Including named files</a></li>
    <li><a id="toc-Searching-for-include-files" href="#Search-Path">8.2 Searching for include files</a></li>
  </ul></li>
  <li><a id="toc-Diverting-and-undiverting-output" href="#Diversions">9 Diverting and undiverting output</a>
  <ul class="no-bullet">
    <li><a id="toc-Diverting-output" href="#Divert">9.1 Diverting output</a></li>
    <li><a id="toc-Undiverting-output" href="#Undivert">9.2 Undiverting output</a></li>
    <li><a id="toc-Diversion-numbers" href="#Divnum">9.3 Diversion numbers</a></li>
    <li><a id="toc-Discarding-diverted-text" href="#Cleardiv">9.4 Discarding diverted text</a></li>
  </ul></li>
  <li><a id="toc-Macros-for-text-handling" href="#Text-handling">10 Macros for text handling</a>
  <ul class="no-bullet">
    <li><a id="toc-Calculating-length-of-strings" href="#Len">10.1 Calculating length of strings</a></li>
    <li><a id="toc-Searching-for-substrings" href="#Index">10.2 Searching for substrings</a></li>
    <li><a id="toc-Searching-for-regular-expressions" href="#Regexp">10.3 Searching for regular expressions</a></li>
    <li><a id="toc-Extracting-substrings" href="#Substr">10.4 Extracting substrings</a></li>
    <li><a id="toc-Translating-characters" href="#Translit">10.5 Translating characters</a></li>
    <li><a id="toc-Substituting-text-by-regular-expression" href="#Patsubst">10.6 Substituting text by regular expression</a></li>
    <li><a id="toc-Formatted-output" href="#Format">10.7 Formatted output</a></li>
  </ul></li>
  <li><a id="toc-Macros-for-doing-arithmetic" href="#Arithmetic">11 Macros for doing arithmetic</a>
  <ul class="no-bullet">
    <li><a id="toc-Decrement-and-increment-operators" href="#Incr">11.1 Decrement and increment operators</a></li>
    <li><a id="toc-Evaluating-integer-expressions" href="#Eval">11.2 Evaluating integer expressions</a></li>
  </ul></li>
  <li><a id="toc-Running-UNIX-commands" href="#UNIX-commands">12 Running UNIX commands</a>
  <ul class="no-bullet">
    <li><a id="toc-Executing-simple-commands" href="#Syscmd">12.1 Executing simple commands</a></li>
    <li><a id="toc-Reading-the-output-of-commands" href="#Esyscmd">12.2 Reading the output of commands</a></li>
    <li><a id="toc-Exit-codes" href="#Sysval">12.3 Exit codes</a></li>
    <li><a id="toc-Making-names-for-temporary-files" href="#Maketemp">12.4 Making names for temporary files</a></li>
  </ul></li>
  <li><a id="toc-Miscellaneous-builtin-macros" href="#Miscellaneous">13 Miscellaneous builtin macros</a>
  <ul class="no-bullet">
    <li><a id="toc-Printing-error-messages" href="#Errprint">13.1 Printing error messages</a></li>
    <li><a id="toc-Exiting-from-m4" href="#M4exit">13.2 Exiting from <code>m4</code></a></li>
  </ul></li>
  <li><a id="toc-Fast-loading-of-frozen-states" href="#Frozen-files">14 Fast loading of frozen states</a></li>
  <li><a id="toc-Compatibility-with-other-versions-of-m4" href="#Compatibility">15 Compatibility with other versions of <code>m4</code></a>
  <ul class="no-bullet">
    <li><a id="toc-Extensions-in-GNU-m4" href="#Extensions">15.1 Extensions in GNU <code>m4</code></a></li>
    <li><a id="toc-Facilities-in-System-V-m4-not-in-GNU-m4" href="#Incompatibilities">15.2 Facilities in System V <code>m4</code> not in GNU <code>m4</code></a></li>
    <li><a id="toc-Other-incompatibilities" href="#Other-Incompat">15.3 Other incompatibilities</a></li>
  </ul></li>
  <li><a id="toc-Concept-index-1" href="#Concept-index" rel="index">Concept index</a></li>
  <li><a id="toc-Macro-index-1" href="#Macro-index" rel="index">Macro index</a></li>
</ul>
</div>

<hr>



</body>
</html>
